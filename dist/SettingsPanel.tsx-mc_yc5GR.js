import{j as n}from"./assets/index-DNcHv8Gn.js";import{R as d}from"./chunk-DJ1oPbzn.js";import"./chunk-B6LuprgX.js";const h=({engine:o,onApplied:m})=>{const[r,u]=d.useState(()=>new Date().toISOString().split("T")[0]),g=()=>{const t=o.exportCurrentBalancesAsOpeningDetails(),a={openingBalances:{date:r,entries:t}},l=new Blob([JSON.stringify(a,null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(l),e=document.createElement("a");e.href=s,e.download=`opening-${r}.json`,document.body.appendChild(e),e.click(),e.remove(),URL.revokeObjectURL(s)},f=async t=>{var l,s;const a=(l=t.target.files)==null?void 0:l[0];if(a)try{const e=await a.text(),c=JSON.parse(e);if(!c.openingBalances)throw new Error("openingBalancesが見つかりません");const p=o.createOpeningBalance(c.openingBalances.date,c.openingBalances.entries);p.success?(alert("期首残高を適用しました"),m()):alert("適用に失敗: "+((s=p.errors)==null?void 0:s.join(", ")))}catch(e){alert(`適用に失敗: ${e.message??String(e)}`)}finally{t.target.value=""}},i=d.useRef(null);return n.jsxs("div",{className:"card mt-3",children:[n.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[n.jsx("strong",{children:"設定/期首残高"}),n.jsxs("div",{children:[n.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:g,children:"現残高を期首JSONとして出力"}),n.jsx("button",{className:"btn btn-sm btn-outline-primary ms-2",onClick:()=>{var t;return(t=i.current)==null?void 0:t.click()},children:"期首JSONを適用"}),n.jsx("input",{ref:i,type:"file",accept:"application/json,.json",style:{display:"none"},onChange:f})]})]}),n.jsxs("div",{className:"card-body d-flex align-items-center gap-2",children:[n.jsx("label",{className:"form-label mb-0",children:"期首日"}),n.jsx("input",{className:"form-control",style:{maxWidth:200},type:"date",value:r,onChange:t=>u(t.target.value)})]})]})};export{h as SettingsPanel};
