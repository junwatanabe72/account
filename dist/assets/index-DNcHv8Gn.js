const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["FreeeStyleJournalForm.tsx-54MbtbaE.js","chunk-DJ1oPbzn.js","chunk-xo-tfjFm.js","chunk-B6LuprgX.js","assets/FreeeStyleJournalForm-BEdt-A8c.css","BankImportWizard.tsx-BB5uTOD2.js","chunk-DMm3EenX.js","AuxiliaryLedgerView.tsx-gInRy3Xf.js","IncomeDetailView.tsx-BSbSVmjC.js","chunk-nbQFM0MW.js","ExpenseDetailView.tsx-DwY2w0Mz.js","IncomeExpenseReport.tsx-CQf6jjWZ.js","DivisionStatementsPanel.tsx-DsrsM4xr.js","ChartOfAccountsPanel.tsx-OHF2hpai.js","BankAccountPanel.tsx-gvECbw6N.js","chunk-D7WOVkBo.js","assets/BankAccountPanel-CXm-QK0H.css","ClosingPanel.tsx-dJUMi3ol.js","SampleDataPanel.tsx-BsM7pWKT.js","ExportPanel.tsx-CcTqncdm.js","LocalStoragePanel.tsx-BxEisxGN.js","SettingsPanel.tsx-mc_yc5GR.js","PrintPanel.tsx-EYeI79qq.js","JsonSpecView.tsx-2YNTk7X6.js","ManualView.tsx-BXisQnd2.js","PaymentTestPanel.tsx-DBYYp7ZH.js"])))=>i.map(i=>d[i]);
var ae=Object.defineProperty;var ce=(c,e,t)=>e in c?ae(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var v=(c,e,t)=>ce(c,typeof e!="symbol"?e+"":e,t);import{r as f,a as ue,R as le}from"../chunk-DJ1oPbzn.js";import{c as de}from"../chunk-B6LuprgX.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();var ie={exports:{}},M={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var me=f,pe=Symbol.for("react.element"),ve=Symbol.for("react.fragment"),he=Object.prototype.hasOwnProperty,ye=me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fe={key:!0,ref:!0,__self:!0,__source:!0};function ne(c,e,t){var i,n={},o=null,r=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(r=e.ref);for(i in e)he.call(e,i)&&!fe.hasOwnProperty(i)&&(n[i]=e[i]);if(c&&c.defaultProps)for(i in e=c.defaultProps,e)n[i]===void 0&&(n[i]=e[i]);return{$$typeof:pe,type:c,key:o,ref:r,props:n,_owner:ye.current}}M.Fragment=ve;M.jsx=ne;M.jsxs=ne;ie.exports=M;var d=ie.exports;const Ae=[{code:"1000",name:"流動資産",shortName:"流動資産",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:1e3},{code:"1100",name:"現金預金",shortName:"現預金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"COMMON",displayOrder:1100},{code:"1101",name:"現金",shortName:"現金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1100",isPostable:!0,divisionCode:"KANRI",displayOrder:1101,description:"小口現金"},{code:"1102",name:"普通預金",shortName:"普通預金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1100",isPostable:!0,divisionCode:"KANRI",displayOrder:1102,description:"管理費口座"},{code:"1103",name:"普通預金（修繕）",shortName:"普通預金（修）",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1100",isPostable:!0,divisionCode:"SHUZEN",displayOrder:1103,description:"修繕積立金口座"},{code:"1104",name:"定期預金",shortName:"定期預金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1100",isPostable:!0,divisionCode:"SHUZEN",displayOrder:1104},{code:"1105",name:"普通預金（駐車場）",shortName:"普通預金（駐）",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1100",isPostable:!0,divisionCode:"PARKING",displayOrder:1105,description:"駐車場会計口座"},{code:"1200",name:"有価証券",shortName:"有価証券",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"SHUZEN",displayOrder:1200},{code:"1201",name:"国債",shortName:"国債",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1200",isPostable:!0,divisionCode:"SHUZEN",displayOrder:1201,description:"国債,地方債,すまい・る債"},{code:"1300",name:"未収入金",shortName:"未収入金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"COMMON",displayOrder:1300},{code:"1301",name:"管理費未収金",shortName:"管理費未収",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1300",isPostable:!0,divisionCode:"KANRI",displayOrder:1301},{code:"1302",name:"修繕積立金未収金",shortName:"修繕未収",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1300",isPostable:!0,divisionCode:"SHUZEN",displayOrder:1302},{code:"1303",name:"使用料未収金",shortName:"使用料未収",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1300",isPostable:!0,divisionCode:"KANRI",displayOrder:1303},{code:"1400",name:"前払費用",shortName:"前払費用",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"COMMON",displayOrder:1400},{code:"1401",name:"前払保険料",shortName:"前払保険料",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1400",isPostable:!0,divisionCode:"COMMON",displayOrder:1401,description:"未経過保険料,保守契約前払"},{code:"1500",name:"仮払金",shortName:"仮払金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"COMMON",displayOrder:1500},{code:"1501",name:"仮払金",shortName:"仮払金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1500",isPostable:!0,divisionCode:"COMMON",displayOrder:1501,description:"立替,一時払,精算待ち"},{code:"1600",name:"前払金",shortName:"前払金",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:2,parentCode:"1000",isPostable:!1,divisionCode:"COMMON",displayOrder:1600},{code:"1601",name:"工事前払金",shortName:"工事前払",category:"ASSET",subCategory:"流動資産",accountType:"DEBIT",level:3,parentCode:"1600",isPostable:!0,divisionCode:"SHUZEN",displayOrder:1601,description:"工事前払金,契約金"},{code:"1700",name:"非流動資産",shortName:"非流動資産",category:"ASSET",subCategory:"非流動資産",accountType:"DEBIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:1700},{code:"1710",name:"投資その他の資産",shortName:"投資その他",category:"ASSET",subCategory:"非流動資産",accountType:"DEBIT",level:2,parentCode:"1700",isPostable:!1,divisionCode:"COMMON",displayOrder:1710},{code:"1711",name:"差入保証金",shortName:"差入保証金",category:"ASSET",subCategory:"非流動資産",accountType:"DEBIT",level:3,parentCode:"1710",isPostable:!0,divisionCode:"COMMON",displayOrder:1711,description:"駐車場敷金,施設保証金"},{code:"1720",name:"繰延資産",shortName:"繰延資産",category:"ASSET",subCategory:"非流動資産",accountType:"DEBIT",level:2,parentCode:"1700",isPostable:!1,divisionCode:"COMMON",displayOrder:1720},{code:"1721",name:"長期前払費用",shortName:"長期前払費用",category:"ASSET",subCategory:"非流動資産",accountType:"DEBIT",level:3,parentCode:"1720",isPostable:!0,divisionCode:"COMMON",displayOrder:1721,description:"長期保険料,長期保守料"},{code:"2000",name:"流動負債",shortName:"流動負債",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:2e3},{code:"2100",name:"未払金",shortName:"未払金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:2,parentCode:"2000",isPostable:!1,divisionCode:"COMMON",displayOrder:2100},{code:"2101",name:"未払金",shortName:"未払金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2100",isPostable:!0,divisionCode:"COMMON",displayOrder:2101,description:"工事代未払,水道光熱費未払"},{code:"2200",name:"未払費用",shortName:"未払費用",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:2,parentCode:"2000",isPostable:!1,divisionCode:"COMMON",displayOrder:2200},{code:"2201",name:"未払費用",shortName:"未払費用",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2200",isPostable:!0,divisionCode:"COMMON",displayOrder:2201,description:"役務提供未払"},{code:"2300",name:"前受金",shortName:"前受金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:2,parentCode:"2000",isPostable:!1,divisionCode:"COMMON",displayOrder:2300},{code:"2301",name:"管理費前受金",shortName:"管理費前受",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2300",isPostable:!0,divisionCode:"KANRI",displayOrder:2301},{code:"2302",name:"修繕積立金前受金",shortName:"修繕前受",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2300",isPostable:!0,divisionCode:"SHUZEN",displayOrder:2302},{code:"2303",name:"使用料前受金",shortName:"使用料前受",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2300",isPostable:!0,divisionCode:"KANRI",displayOrder:2303},{code:"2400",name:"仮受金",shortName:"仮受金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:2,parentCode:"2000",isPostable:!1,divisionCode:"COMMON",displayOrder:2400},{code:"2401",name:"仮受金",shortName:"仮受金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2400",isPostable:!0,divisionCode:"COMMON",displayOrder:2401,description:"一時受入,原因不明入金"},{code:"2500",name:"預り金",shortName:"預り金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:2,parentCode:"2000",isPostable:!1,divisionCode:"COMMON",displayOrder:2500},{code:"2501",name:"預り金",shortName:"預り金",category:"LIABILITY",subCategory:"流動負債",accountType:"CREDIT",level:3,parentCode:"2500",isPostable:!0,divisionCode:"COMMON",displayOrder:2501,description:"敷金,保証金"},{code:"3000",name:"固定負債",shortName:"固定負債",category:"LIABILITY",subCategory:"固定負債",accountType:"CREDIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:3e3},{code:"3100",name:"長期借入金",shortName:"長期借入金",category:"LIABILITY",subCategory:"固定負債",accountType:"CREDIT",level:2,parentCode:"3000",isPostable:!1,divisionCode:"SHUZEN",displayOrder:3100},{code:"3101",name:"長期借入金",shortName:"長期借入金",category:"LIABILITY",subCategory:"固定負債",accountType:"CREDIT",level:3,parentCode:"3100",isPostable:!0,divisionCode:"SHUZEN",displayOrder:3101,description:"修繕資金借入,工事融資"},{code:"4000",name:"純資産",shortName:"純資産",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:4e3},{code:"4100",name:"繰越金",shortName:"繰越金",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:2,parentCode:"4000",isPostable:!1,divisionCode:"COMMON",displayOrder:4100},{code:"4101",name:"管理費繰越金",shortName:"管理費繰越",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:3,parentCode:"4100",isPostable:!0,divisionCode:"KANRI",displayOrder:4101},{code:"4102",name:"修繕積立金繰越金",shortName:"修繕繰越",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:3,parentCode:"4100",isPostable:!0,divisionCode:"SHUZEN",displayOrder:4102},{code:"4103",name:"駐車場会計繰越金",shortName:"駐車場繰越",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:3,parentCode:"4100",isPostable:!0,divisionCode:"PARKING",displayOrder:4103},{code:"4104",name:"その他会計繰越金",shortName:"その他繰越",category:"EQUITY",subCategory:"純資産",accountType:"CREDIT",level:3,parentCode:"4100",isPostable:!0,divisionCode:"OTHER",displayOrder:4104},{code:"5000",name:"収益",shortName:"収益",category:"REVENUE",subCategory:"収益",accountType:"CREDIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:5e3},{code:"5100",name:"管理収益",shortName:"管理収益",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:2,parentCode:"5000",isPostable:!1,divisionCode:"KANRI",displayOrder:5100},{code:"5101",name:"管理費収入",shortName:"管理費",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5101},{code:"5102",name:"駐車場使用料収入",shortName:"駐車場",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5102,description:"月極駐車場,来客用駐車場"},{code:"5103",name:"駐輪場使用料収入",shortName:"駐輪場",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5103,description:"自転車置場,バイク置場"},{code:"5107",name:"駐車場収入",shortName:"駐車場収入",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"PARKING",displayOrder:5107,description:"月極駐車場収入（駐車場会計）"},{code:"5104",name:"ルーフバルコニー使用料収入",shortName:"ルーフバルコニー",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5104,description:"屋上バルコニー専用使用料"},{code:"5105",name:"テラス使用料収入",shortName:"テラス",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5105,description:"専用庭,テラス専用使用料"},{code:"5106",name:"集会室使用料収入",shortName:"集会室",category:"REVENUE",subCategory:"管理収益",accountType:"CREDIT",level:3,parentCode:"5100",isPostable:!0,divisionCode:"KANRI",displayOrder:5106,description:"共用施設使用料"},{code:"5200",name:"積立金収入",shortName:"積立金収入",category:"REVENUE",subCategory:"積立金収入",accountType:"CREDIT",level:2,parentCode:"5000",isPostable:!1,divisionCode:"SHUZEN",displayOrder:5200},{code:"5201",name:"修繕積立金収入",shortName:"修繕積立金",category:"REVENUE",subCategory:"積立金収入",accountType:"CREDIT",level:3,parentCode:"5200",isPostable:!0,divisionCode:"SHUZEN",displayOrder:5201},{code:"5300",name:"営業外収益",shortName:"営業外収益",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:2,parentCode:"5000",isPostable:!1,divisionCode:"COMMON",displayOrder:5300},{code:"5301",name:"受取利息",shortName:"受取利息",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:3,parentCode:"5300",isPostable:!0,divisionCode:"COMMON",displayOrder:5301,description:"預金利息,債券利息"},{code:"5302",name:"雑収入",shortName:"雑収入",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:3,parentCode:"5300",isPostable:!0,divisionCode:"COMMON",displayOrder:5302,description:"保険金,自販機手数料"},{code:"5303",name:"延滞金収入",shortName:"延滞金",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:3,parentCode:"5300",isPostable:!0,divisionCode:"KANRI",displayOrder:5303},{code:"5304",name:"受取保険金",shortName:"保険金",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:3,parentCode:"5300",isPostable:!0,divisionCode:"COMMON",displayOrder:5304},{code:"5305",name:"補助金収入",shortName:"補助金",category:"REVENUE",subCategory:"営業外収益",accountType:"CREDIT",level:3,parentCode:"5300",isPostable:!0,divisionCode:"COMMON",displayOrder:5305},{code:"5400",name:"特別収益",shortName:"特別収益",category:"REVENUE",subCategory:"特別収益",accountType:"CREDIT",level:2,parentCode:"5000",isPostable:!1,divisionCode:"COMMON",displayOrder:5400},{code:"5401",name:"特別徴収金収入",shortName:"特別徴収金",category:"REVENUE",subCategory:"特別収益",accountType:"CREDIT",level:3,parentCode:"5400",isPostable:!0,divisionCode:"SHUZEN",displayOrder:5401},{code:"5402",name:"繰入金収入",shortName:"繰入金",category:"REVENUE",subCategory:"特別収益",accountType:"CREDIT",level:3,parentCode:"5400",isPostable:!0,divisionCode:"SHUZEN",displayOrder:5402},{code:"6000",name:"費用",shortName:"費用",category:"EXPENSE",subCategory:"費用",accountType:"DEBIT",level:1,isPostable:!1,divisionCode:"COMMON",displayOrder:6e3},{code:"6100",name:"管理費",shortName:"管理費",category:"EXPENSE",subCategory:"管理費",accountType:"DEBIT",level:2,parentCode:"6000",isPostable:!1,divisionCode:"KANRI",displayOrder:6100},{code:"6101",name:"管理委託費",shortName:"管理委託費",category:"EXPENSE",subCategory:"管理費",accountType:"DEBIT",level:3,parentCode:"6100",isPostable:!0,divisionCode:"KANRI",displayOrder:6101,description:"事務管理,管理員,清掃,設備管理"},{code:"6102",name:"水道光熱費",shortName:"水道光熱費",category:"EXPENSE",subCategory:"管理費",accountType:"DEBIT",level:3,parentCode:"6100",isPostable:!0,divisionCode:"KANRI",displayOrder:6102,description:"電気料金,水道料金"},{code:"6103",name:"通信費",shortName:"通信費",category:"EXPENSE",subCategory:"管理費",accountType:"DEBIT",level:3,parentCode:"6100",isPostable:!0,divisionCode:"KANRI",displayOrder:6103,description:"郵送料,電話代,インターネット"},{code:"6104",name:"保険料",shortName:"保険料",category:"EXPENSE",subCategory:"管理費",accountType:"DEBIT",level:3,parentCode:"6100",isPostable:!0,divisionCode:"KANRI",displayOrder:6104,description:"マンション共用部保険"},{code:"6200",name:"維持修繕費",shortName:"維持修繕費",category:"EXPENSE",subCategory:"維持修繕費",accountType:"DEBIT",level:2,parentCode:"6000",isPostable:!1,divisionCode:"COMMON",displayOrder:6200},{code:"6201",name:"修繕費",shortName:"修繕費",category:"EXPENSE",subCategory:"維持修繕費",accountType:"DEBIT",level:3,parentCode:"6200",isPostable:!0,divisionCode:"KANRI",displayOrder:6201,description:"軽微修繕,日常補修"},{code:"6300",name:"一般管理費",shortName:"一般管理費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:2,parentCode:"6000",isPostable:!1,divisionCode:"KANRI",displayOrder:6300},{code:"6301",name:"消耗品費",shortName:"消耗品費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6301},{code:"6302",name:"支払手数料",shortName:"手数料",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6302,description:"振込手数料,残高証明料"},{code:"6303",name:"会議費",shortName:"会議費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6303,description:"理事会,総会"},{code:"6304",name:"役員手当",shortName:"役員手当",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6304},{code:"6305",name:"専門家謝金",shortName:"専門家謝金",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6305,description:"弁護士,税理士,建築士"},{code:"6306",name:"印刷費",shortName:"印刷費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6306},{code:"6307",name:"租税公課",shortName:"租税公課",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6307},{code:"6308",name:"雑費",shortName:"雑費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6308},{code:"6310",name:"駐車場管理費",shortName:"駐車場管理費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"PARKING",displayOrder:6310,description:"駐車場運営費"},{code:"6309",name:"旅費交通費",shortName:"旅費交通費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6309,description:"交通費,旅費,実費精算"},{code:"6311",name:"諸会費",shortName:"諸会費",category:"EXPENSE",subCategory:"一般管理費",accountType:"DEBIT",level:3,parentCode:"6300",isPostable:!0,divisionCode:"KANRI",displayOrder:6310,description:"自治会費,加入団体会費"},{code:"6400",name:"長期修繕費",shortName:"長期修繕費",category:"EXPENSE",subCategory:"長期修繕",accountType:"DEBIT",level:2,parentCode:"6000",isPostable:!1,divisionCode:"SHUZEN",displayOrder:6400},{code:"6401",name:"修繕工事費",shortName:"修繕工事費",category:"EXPENSE",subCategory:"長期修繕",accountType:"DEBIT",level:3,parentCode:"6400",isPostable:!0,divisionCode:"SHUZEN",displayOrder:6401,description:"大規模修繕工事,計画修繕"},{code:"6402",name:"設計監理費",shortName:"設計監理費",category:"EXPENSE",subCategory:"長期修繕",accountType:"DEBIT",level:3,parentCode:"6400",isPostable:!0,divisionCode:"SHUZEN",displayOrder:6402},{code:"6500",name:"特別損失",shortName:"特別損失",category:"EXPENSE",subCategory:"特別損失",accountType:"DEBIT",level:2,parentCode:"6000",isPostable:!1,divisionCode:"COMMON",displayOrder:6500},{code:"6501",name:"繰出金",shortName:"繰出金",category:"EXPENSE",subCategory:"特別損失",accountType:"DEBIT",level:3,parentCode:"6500",isPostable:!0,divisionCode:"KANRI",displayOrder:6501,description:"修繕会計繰出"},{code:"6503",name:"その他支出",shortName:"その他支出",category:"EXPENSE",subCategory:"特別損失",accountType:"DEBIT",level:3,parentCode:"6500",isPostable:!0,divisionCode:"OTHER",displayOrder:6503,description:"その他特別会計支出"},{code:"6502",name:"雑損失",shortName:"雑損失",category:"EXPENSE",subCategory:"特別損失",accountType:"DEBIT",level:3,parentCode:"6500",isPostable:!0,divisionCode:"COMMON",displayOrder:6502}];class H{constructor(e,t,i,n,o=["KANRI","SHUZEN","PARKING","OTHER"],r,s=!0){v(this,"balance",0);v(this,"hasAuxiliary",!1);v(this,"auxiliaryLedgers",new Map);v(this,"parent",null);v(this,"children",[]);v(this,"parentCode");v(this,"isPostable",!0);v(this,"level");this.code=e,this.name=t,this.type=i,this.normalBalance=n,this.availableDivisions=o,this.description=r,this.isActive=s}createAuxiliaryLedger(e,t,i={}){const n=new ge(this.code,e,t,i);return this.auxiliaryLedgers.set(e,n),this.hasAuxiliary=!0,n}getAuxiliaryLedger(e){return this.auxiliaryLedgers.get(e)}getAllAuxiliaryLedgers(){return Array.from(this.auxiliaryLedgers.values())}getAuxiliaryTotalBalance(){let e=0;return this.auxiliaryLedgers.forEach(t=>e+=t.balance),e}addToBalance(e,t){const i=t?e:-e;this.balance+=this.normalBalance==="DEBIT"?i:-i}getDisplayBalance(){return Math.abs(this.balance)}isDebitBalance(){return this.normalBalance==="DEBIT"?this.balance>=0:this.balance<0}addChild(e){this.children.push(e),e.parent=this}}class ge{constructor(e,t,i,n={}){v(this,"balance",0);v(this,"transactions",[]);v(this,"isActive",!0);v(this,"createdAt",new Date);this.masterAccountCode=e,this.auxiliaryCode=t,this.name=i,this.attributes=n}addTransaction(e,t,i,n){const o={date:new Date,amount:e,isDebit:t,journalId:i,description:n,balance:this.balance,balanceAfter:0};this.balance+=t?e:-e,o.balanceAfter=this.balance,this.transactions.push(o)}getDisplayBalance(){return Math.abs(this.balance)}isDebitBalance(){return this.balance>=0}}class D{constructor(){v(this,"accountsMap",new Map)}get accounts(){return Array.from(this.accountsMap.values())}mapCategoryToAccountType(e){switch(e){case"ASSET":return"ASSET";case"LIABILITY":return"LIABILITY";case"EQUITY":return"EQUITY";case"REVENUE":return"REVENUE";case"EXPENSE":return"EXPENSE";default:return"ASSET"}}getDivisionsFromLegacyDivisionCode(e){switch(e){case"KANRI":return["KANRI"];case"SHUZEN":return["SHUZEN"];case"PARKING":return["PARKING"];case"OTHER":return["OTHER"];case"COMMON":default:return["KANRI","SHUZEN","PARKING","OTHER"]}}initializeAccounts(){const e=Ae.map(t=>({code:t.code,name:t.name,type:this.mapCategoryToAccountType(t.category),normalBalance:t.accountType==="DEBIT"?"DEBIT":"CREDIT",availableDivisions:this.getDivisionsFromLegacyDivisionCode(t.divisionCode),parentCode:t.parentCode,description:t.description,isActive:!0,level:t.level,isPostable:t.isPostable}));this.rebuildAccountsFrom(e)}rebuildAccountsFrom(e){this.accountsMap.clear();const t=new Map;for(const i of e){const n=new H(i.code,i.name,i.type,i.normalBalance,i.availableDivisions||["KANRI","SHUZEN","PARKING","OTHER"],i.description,i.isActive!==!1);n.parentCode=i.parentCode,i.level!==void 0&&(n.level=i.level),i.isPostable!==void 0&&(n.isPostable=i.isPostable),this.accountsMap.set(i.code,n),i.parentCode&&(t.has(i.parentCode)||t.set(i.parentCode,[]),t.get(i.parentCode).push(n))}for(const i of this.accountsMap.values())if(i.parentCode){const n=this.accountsMap.get(i.parentCode);n&&n.addChild(i)}}addOrUpdateAccount(e){const t=this.accountsMap.get(e.code),i=t||new H(e.code,e.name,e.type,e.normalBalance,e.availableDivisions||["KANRI","SHUZEN","PARKING","OTHER"],e.description,e.isActive!==!1);if(t?(i.name=e.name,i.type=e.type,i.normalBalance=e.normalBalance,i.availableDivisions=e.availableDivisions||["KANRI","SHUZEN","PARKING","OTHER"],i.description=e.description,e.isActive!==void 0&&(i.isActive=e.isActive),e.level!==void 0&&(i.level=e.level),e.isPostable!==void 0&&(i.isPostable=e.isPostable)):(this.accountsMap.set(e.code,i),e.level!==void 0&&(i.level=e.level),e.isPostable!==void 0&&(i.isPostable=e.isPostable)),e.parentCode){const n=this.accountsMap.get(e.parentCode);n&&!t&&n.addChild(i)}return i}setAccountActive(e,t){const i=this.accountsMap.get(e);i&&(i.isActive=t)}getAccounts(){return Array.from(this.accountsMap.values()).sort((e,t)=>e.code.localeCompare(t.code))}getAccount(e){return this.accountsMap.get(e)}clearAccounts(){this.accountsMap.clear()}rebuildAuxiliaryAccounts(){const e=this.accountsMap.get("1121"),t=this.accountsMap.get("1122");e&&(e.auxiliaryLedgers.clear(),e.hasAuxiliary=!1),t&&(t.auxiliaryLedgers.clear(),t.hasAuxiliary=!1)}}const U={BALANCE_THRESHOLD:.01},b={KANRI:"KANRI",SHUZEN:"SHUZEN",PARKING:"PARKING",SHARED:"SHARED",SPECIAL:"SPECIAL"},j={[b.KANRI]:"管理費会計",[b.SHUZEN]:"修繕積立金会計",[b.PARKING]:"駐車場会計",[b.SHARED]:"共通",[b.SPECIAL]:"特別会計"},Kt={DRAFT:"DRAFT",POSTED:"POSTED"},T={JOURNAL_NOT_FOUND:"仕訳が見つかりません",JOURNAL_STATUS_INVALID:"仕訳のステータスが不正です",JOURNAL_ALREADY_POSTED:"既に記帳済みの仕訳です",JOURNAL_POSTED_CANNOT_DELETE:"記帳済みの仕訳は削除できません",JOURNAL_NOT_EDITABLE:"編集可能な状態ではありません",JOURNAL_DATE_REQUIRED:"仕訳日付は必須です",JOURNAL_DESCRIPTION_REQUIRED:"仕訳摘要は必須です",JOURNAL_DETAILS_REQUIRED:"仕訳明細は必須です",JOURNAL_NOT_BALANCED:"貸借が一致していません"};class F{constructor(e,t,i,n,o){this.accountCode=e,this.debitAmount=t,this.creditAmount=i,this.description=n,this.auxiliaryCode=o}getAmount(){return this.debitAmount||this.creditAmount}isDebit(){return this.debitAmount>0}}class Ce{constructor(e,t,i="",n){v(this,"id");v(this,"number","");v(this,"details",[]);v(this,"status","DRAFT");v(this,"createdAt",new Date);v(this,"postedAt");v(this,"meta",{});v(this,"division");this.date=e,this.description=t,this.id=`j_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i&&(this.meta.reference=i),this.division=n}addDetail(e){this.details.push(e)}getTotalDebit(){return this.details.reduce((e,t)=>e+t.debitAmount,0)}getTotalCredit(){return this.details.reduce((e,t)=>e+t.creditAmount,0)}isBalanced(){return Math.abs(this.getTotalDebit()-this.getTotalCredit())<U.BALANCE_THRESHOLD}validate(){const e=[];return this.date||e.push(T.JOURNAL_DATE_REQUIRED),this.description||e.push(T.JOURNAL_DESCRIPTION_REQUIRED),this.details.length===0&&e.push(T.JOURNAL_DETAILS_REQUIRED),this.isBalanced()||e.push(T.JOURNAL_NOT_BALANCED),e}}class _{constructor(e,t){v(this,"journals",[]);this.accountService=e,this.divisionService=t}createJournal(e,t){const i=new Ce(e.date,e.description,e.reference||"",e.division);for(const r of e.details){const s=this.accountService.getAccount(r.accountCode);if(!s)return{success:!1,errors:[`勘定科目 ${r.accountCode} が見つかりません`]};if(!s.isActive)return{success:!1,errors:[`勘定科目 ${r.accountCode} は無効です`]};i.addDetail(new F(r.accountCode,r.debitAmount||0,r.creditAmount||0,r.description,r.auxiliaryCode))}const n=i.validate();if(n.length>0)return{success:!1,errors:n};const o=this.validateDivisionAccounting(i);return o.success?(t!=null&&t.meta&&Object.assign(i.meta,t.meta),i.number=`J${String(this.journals.length+1).padStart(6,"0")}`,this.journals.push(i),(t==null?void 0:t.autoPost)!==!1?this.postJournal(i):{success:!0,journal:i}):o}submitJournal(e){const t=this.journals.find(i=>i.id===e);return t?t.status!=="DRAFT"?{success:!1,errors:[T.JOURNAL_STATUS_INVALID]}:(t.status="SUBMITTED",{success:!0,journal:t}):{success:!1,errors:[T.JOURNAL_NOT_FOUND]}}approveJournal(e){const t=this.journals.find(i=>i.id===e);return t?t.status!=="SUBMITTED"?{success:!1,errors:[T.JOURNAL_STATUS_INVALID]}:(t.status="APPROVED",{success:!0,journal:t}):{success:!1,errors:[T.JOURNAL_NOT_FOUND]}}postJournalById(e){const t=this.journals.find(i=>i.id===e);return t?t.status==="POSTED"?{success:!1,errors:[T.JOURNAL_ALREADY_POSTED]}:this.postJournal(t):{success:!1,errors:[T.JOURNAL_NOT_FOUND]}}deleteJournal(e){const t=this.journals.findIndex(n=>n.id===e);if(t===-1)return{success:!1,errors:[T.JOURNAL_NOT_FOUND]};const i=this.journals[t];return i?i.status==="POSTED"?{success:!1,errors:[T.JOURNAL_POSTED_CANNOT_DELETE]}:(this.journals.splice(t,1),{success:!0}):{success:!1,errors:[T.JOURNAL_NOT_FOUND]}}updateJournal(e,t){const i=this.journals.findIndex(r=>r.id===e);if(i===-1)return{success:!1,errors:[T.JOURNAL_NOT_FOUND]};const n=this.journals[i];if(!n)return{success:!1,errors:[T.JOURNAL_NOT_FOUND]};if(n.status!=="DRAFT")return{success:!1,errors:[T.JOURNAL_NOT_EDITABLE]};if(t.date!==void 0&&(n.date=t.date),t.description!==void 0&&(n.description=t.description),t.reference!==void 0&&(n.meta.reference=t.reference),t.details){n.details=[];for(const r of t.details)n.addDetail(new F(r.accountCode,r.debitAmount||0,r.creditAmount||0,r.description,r.auxiliaryCode))}const o=n.validate();return o.length>0?{success:!1,errors:o}:{success:!0,journal:n}}validateDivisionAccounting(e){const t=new Map;for(const n of e.details){const o=this.accountService.getAccount(n.accountCode);if(o&&o.division){t.has(o.division)||t.set(o.division,{debit:0,credit:0});const r=t.get(o.division);r.debit+=n.debitAmount,r.credit+=n.creditAmount}}const i=Array.from(t.keys());if(i.length>1)for(let n=0;n<i.length;n++)for(let o=n+1;o<i.length;o++){const r=i[n],s=i[o];if(r&&s){const a=this.divisionService.getDivision(r),u=t.get(s);if(a){const l=Math.max(u.debit,u.credit);if(!a.canTransferTo(s,l))return{success:!1,errors:[`区分${r}から${s}への振替制限を超えています`]}}}}return{success:!0}}postJournal(e){if(e.status==="POSTED")return{success:!1,errors:[T.JOURNAL_ALREADY_POSTED]};for(const t of e.details){const i=this.accountService.getAccount(t.accountCode);if(i){if(i.addToBalance(t.getAmount(),t.isDebit()),t.auxiliaryCode&&i.hasAuxiliary){const n=i.getAuxiliaryLedger(t.auxiliaryCode);n&&n.addTransaction(t.getAmount(),t.isDebit(),e.id,e.description)}if(i.division){const n=this.divisionService.getDivision(i.division);n&&n.addTransaction(e.id,e.date,e.description,t.getAmount(),t.isDebit(),i.type)}}}return e.status="POSTED",e.postedAt=new Date,{success:!0,journal:e}}getJournals(){return this.journals}getJournal(e){return this.journals.find(t=>t.id===e)}clearJournals(){this.journals=[]}}class w{constructor(e,t,i,n=!0){v(this,"transferLimits",{});v(this,"transactions",[]);this.code=e,this.name=t,this.description=i,this.isRequired=n}canTransferTo(e,t){if(this.code===b.SHUZEN&&e!==b.SHUZEN)return!1;const i=this.transferLimits[e];return!(i&&t>i)}setTransferLimit(e,t){this.transferLimits[e]=t}addTransaction(e,t,i,n,o,r){this.transactions.push({journalId:e,date:t,description:i,amount:n,isDebit:o,accountType:r})}getBalance(){let e=0;for(const t of this.transactions)t.accountType==="ASSET"||t.accountType==="EXPENSE"?e+=t.isDebit?t.amount:-t.amount:e+=t.isDebit?-t.amount:t.amount;return e}}class z{constructor(){v(this,"divisionsMap",new Map)}get divisions(){return Array.from(this.divisionsMap.values())}initializeDivisions(){this.divisionsMap.set(b.KANRI,new w(b.KANRI,j[b.KANRI],"管理費会計に関する区分")),this.divisionsMap.set(b.SHUZEN,new w(b.SHUZEN,j[b.SHUZEN],"修繕積立金会計に関する区分")),this.divisionsMap.set(b.PARKING,new w(b.PARKING,j[b.PARKING],"駐車場会計に関する区分")),this.divisionsMap.set(b.SHARED,new w(b.SHARED,j[b.SHARED],"区分共通の会計",!1))}getDivision(e){return this.divisionsMap.get(e)}getDivisions(){return Array.from(this.divisionsMap.values())}clearDivisions(){this.divisionsMap.clear()}}class Y{constructor(e,t,i){this.accountService=e,this.journalService=t,this.divisionService=i}getTrialBalance(){const e=[];let t=0,i=0;for(const n of this.accountService.getAccounts())if(n.balance!==0){const o=n.getDisplayBalance(),r=n.isDebitBalance();e.push({code:n.code,name:n.name,debit:r?o:0,credit:r?0:o}),r?t+=o:i+=o}return{entries:e,totalDebit:t,totalCredit:i}}getIncomeStatement(){const e=[],t=[];let i=0,n=0;for(const r of this.accountService.getAccounts())if(r.balance!==0){const s=r.getDisplayBalance();r.type==="REVENUE"&&(e.push({code:r.code,name:r.name,amount:s}),i+=s),r.type==="EXPENSE"&&(t.push({code:r.code,name:r.name,amount:s}),n+=s)}const o=i-n;return{revenues:e,expenses:t,totalRevenue:i,totalExpense:n,netIncome:o}}getBalanceSheet(){const e=[],t=[],i=[];let n=0,o=0,r=0;for(const a of this.accountService.getAccounts())if(a.balance!==0){const u=a.getDisplayBalance();a.type==="ASSET"&&(e.push({code:a.code,name:a.name,amount:a.normalBalance==="DEBIT"?u:-u}),n+=a.normalBalance==="DEBIT"?u:-u),a.type==="LIABILITY"&&(t.push({code:a.code,name:a.name,amount:u}),o+=u),a.type==="EQUITY"&&(i.push({code:a.code,name:a.name,amount:u}),r+=u)}const s=this.getIncomeStatement();return s.netIncome!==0&&(i.push({code:"9999",name:"当期純利益",amount:s.netIncome}),r+=s.netIncome),{assets:e,liabilities:t,equity:i,totalAssets:n,totalLiabilities:o,totalEquity:r,totalLiabilitiesAndEquity:o+r,isBalanced:Math.abs(n-(o+r))<U.BALANCE_THRESHOLD}}getBalanceSheetDebugInfo(){const e=[],t=[],i=[];let n=0,o=0,r=0;const s=[];for(const l of this.accountService.getAccounts())if(s.push({code:l.code,name:l.name,type:l.type,normalBalance:l.normalBalance,rawBalance:l.balance,displayBalance:l.getDisplayBalance(),isDebitBalance:l.isDebitBalance()}),l.balance!==0){const p=l.getDisplayBalance(),y=l.balance,h=l.normalBalance,N=l.isDebitBalance(),m={code:l.code,name:l.name,amount:p,rawBalance:y,normalBalance:h,isDebitBalance:N};if(l.type==="ASSET"){const S=l.normalBalance==="DEBIT"?p:-p;e.push({...m,amount:S}),n+=S}l.type==="LIABILITY"&&(t.push(m),o+=p),l.type==="EQUITY"&&(i.push(m),r+=p)}const a=this.getIncomeStatement();a.netIncome!==0&&(i.push({code:"9999",name:"当期純利益",amount:a.netIncome,rawBalance:a.netIncome,normalBalance:"CREDIT",isDebitBalance:a.netIncome<0}),r+=a.netIncome);const u=n-(o+r);return{assets:e,liabilities:t,equity:i,totalAssets:n,totalLiabilities:o,totalEquity:r,totalLiabilitiesAndEquity:o+r,isBalanced:Math.abs(u)<U.BALANCE_THRESHOLD,difference:u,accountDetails:s}}getDivisionTrialBalance(){const e={};for(const t of this.divisionService.getDivisions()){const i=[];let n=0,o=0;for(const r of this.accountService.getAccounts())if(r.balance!==0){const s=r.getDisplayBalance(),a=r.isDebitBalance();if(r.division===t.code||r.division===b.SHARED&&t.isRequired)switch(r.type){case"ASSET":case"EXPENSE":i.push({code:r.code,name:r.name,debit:a?s:0,credit:a?0:s}),a?n+=s:o+=s;break;case"LIABILITY":case"EQUITY":case"REVENUE":i.push({code:r.code,name:r.name,debit:a?0:s,credit:a?s:0}),a?o+=s:n+=s;break}}e[t.code]={entries:i,totalDebit:n,totalCredit:o}}return e}getIncomeDetails(e,t,i){const n=new Date(e),o=new Date(t),r=[];for(const s of this.journalService.getJournals()){const a=new Date(s.date);if(a>=n&&a<=o&&s.status==="POSTED"){if(i&&s.division!==i)continue;for(const u of s.details){const l=this.accountService.getAccount(u.accountCode);if(l&&l.type==="REVENUE"){const p=u.creditAmount-u.debitAmount;if(p>0){const y={journalId:s.id,date:s.date,number:s.number,accountCode:u.accountCode,accountName:l.name,description:u.description||s.description,amount:p,division:l.division};if(u.auxiliaryCode&&l.hasAuxiliary){const h=l.getAuxiliaryLedger(u.auxiliaryCode);h&&(y.auxiliaryCode=u.auxiliaryCode,y.auxiliaryName=h.name)}r.push(y)}}}}}return r.sort((s,a)=>s.date.localeCompare(a.date)||s.number.localeCompare(a.number))}getIncomeDetailSummary(e,t,i){const n=this.getIncomeDetails(e,t,i),o=new Map;for(const r of n){const s=r.accountCode;let a=o.get(s);if(a||(a={accountCode:r.accountCode,accountName:r.accountName,amount:0,count:0,division:r.division,auxiliaryDetails:r.auxiliaryCode?new Map:void 0},o.set(s,a)),a.amount+=r.amount,a.count+=1,r.auxiliaryCode&&a.auxiliaryDetails){let u=a.auxiliaryDetails.get(r.auxiliaryCode);u||(u={auxiliaryCode:r.auxiliaryCode,auxiliaryName:r.auxiliaryName,amount:0,count:0},a.auxiliaryDetails.set(r.auxiliaryCode,u)),u.amount+=r.amount,u.count+=1}}return Array.from(o.values()).map(r=>({...r,auxiliaryDetails:r.auxiliaryDetails?Array.from(r.auxiliaryDetails.values()):void 0}))}getExpenseDetails(e,t,i){const n=new Date(e),o=new Date(t),r=[];for(const s of this.journalService.getJournals()){const a=new Date(s.date);if(a>=n&&a<=o&&s.status==="POSTED"){if(i&&s.division!==i)continue;for(const u of s.details){const l=this.accountService.getAccount(u.accountCode);if(l&&l.type==="EXPENSE"){const p=u.debitAmount-u.creditAmount;if(p>0){const y={journalId:s.id,date:s.date,number:s.number,accountCode:u.accountCode,accountName:l.name,description:u.description||s.description,amount:p,division:l.division};if(u.auxiliaryCode&&l.hasAuxiliary){const h=l.getAuxiliaryLedger(u.auxiliaryCode);h&&(y.auxiliaryCode=u.auxiliaryCode,y.auxiliaryName=h.name)}r.push(y)}}}}}return r.sort((s,a)=>s.date.localeCompare(a.date)||s.number.localeCompare(a.number))}getExpenseDetailSummary(e,t,i){const n=this.getExpenseDetails(e,t,i),o=new Map;for(const r of n){const s=r.accountCode;let a=o.get(s);if(a||(a={accountCode:r.accountCode,accountName:r.accountName,amount:0,count:0,division:r.division,auxiliaryDetails:r.auxiliaryCode?new Map:void 0},o.set(s,a)),a.amount+=r.amount,a.count+=1,r.auxiliaryCode&&a.auxiliaryDetails){let u=a.auxiliaryDetails.get(r.auxiliaryCode);u||(u={auxiliaryCode:r.auxiliaryCode,auxiliaryName:r.auxiliaryName,amount:0,count:0},a.auxiliaryDetails.set(r.auxiliaryCode,u)),u.amount+=r.amount,u.count+=1}}return Array.from(o.values()).map(r=>({...r,auxiliaryDetails:r.auxiliaryDetails?Array.from(r.auxiliaryDetails.values()):void 0}))}}class G{constructor(e,t,i,n){this.accountService=e,this.journalService=t,this.divisionService=i,this.auxiliaryService=n}serialize(){return{version:"1.0",exportDate:new Date().toISOString(),unitOwners:this.auxiliaryService.getUnitOwners(),vendors:this.auxiliaryService.getVendors(),journals:this.journalService.getJournals().map(e=>({date:e.date,description:e.description,reference:e.meta.reference,details:e.details.map(t=>({accountCode:t.accountCode,debitAmount:t.debitAmount||void 0,creditAmount:t.creditAmount||void 0,description:t.description,auxiliaryCode:t.auxiliaryCode})),status:e.status,number:e.number}))}}restore(e){if(!(!e||typeof e!="object")&&(this.accountService.clearAccounts(),this.journalService.clearJournals(),this.divisionService.clearDivisions(),this.auxiliaryService.clearAuxiliaries(),this.accountService.initializeAccounts(),this.divisionService.initializeDivisions(),e.unitOwners&&this.auxiliaryService.setUnitOwners(e.unitOwners),e.vendors&&this.auxiliaryService.setVendors(e.vendors),this.auxiliaryService.createUnitOwnerAuxiliaryAccounts(this.accountService),e.journals&&Array.isArray(e.journals)))for(const t of e.journals){const i=this.journalService.createJournal(t,{autoPost:!1});if(i.success&&i.data){const n=i.data;t.status&&t.status!=="POSTED"?(t.status==="SUBMITTED"&&this.journalService.submitJournal(n.id),t.status==="APPROVED"&&this.journalService.approveJournal(n.id)):this.journalService.postJournalById(n.id)}}}importJsonData(e){var t;try{const i=[];if(e.clearExisting){this.journalService.clearJournals(),this.accountService.rebuildAuxiliaryAccounts();for(const n of this.accountService.getAccounts())n.balance=0}if(e.unitOwners){const n=e.unitOwners.filter(o=>o.unitNumber&&o.ownerName);this.auxiliaryService.setUnitOwners(n),this.auxiliaryService.createUnitOwnerAuxiliaryAccounts(this.accountService)}if(e.vendors){const n=e.vendors.filter(o=>o.code&&o.name);this.auxiliaryService.setVendors(n)}if(e.openingBalances&&e.openingBalances.length>0){const n=e.openingBalances[0],o=(n==null?void 0:n.date)??new Date().toISOString().split("T")[0]??"",r=this.createOpeningBalance(o||new Date().toISOString().split("T")[0]||"",e.openingBalances);r.success||i.push({index:-1,success:!1,error:(t=r.errors)==null?void 0:t.join(", ")})}return e.journals&&e.journals.forEach((n,o)=>{var a;if(!n.date||!n.description||!n.details){i.push({index:o,success:!1,error:"必須フィールドが不足しています"});return}let r=!0;for(const u of n.details)(!u.accountCode||!u.debitAmount&&!u.creditAmount)&&(r=!1);if(!r){i.push({index:o,success:!1,error:"仕訳明細の形式が正しくありません（勘定科目コード、借方金額または貸方金額が必要）"});return}const s=this.journalService.createJournal(n,{autoPost:e.autoPost!==!1});s.success?i.push({index:o,success:!0}):i.push({index:o,success:!1,error:(a=s.errors)==null?void 0:a.join(", ")})}),{success:!0,results:i}}catch(i){return{success:!1,error:i.message}}}createOpeningBalance(e,t){const i=[];let n=0,o=0;for(const s of t){const a=this.accountService.getAccount(s.accountCode);if(!a||!a.isActive)continue;a.normalBalance;let u=s.debitAmount||0,l=s.creditAmount||0;(u>0||l>0)&&(i.push({accountCode:s.accountCode,debitAmount:u,creditAmount:l}),n+=u,o+=l)}const r=Math.abs(n-o);if(r>.01){const s=this.accountService.getAccount("3200")||this.accountService.getAccount("3000");s&&(n>o?i.push({accountCode:s.code,creditAmount:r}):i.push({accountCode:s.code,debitAmount:r}))}return i.length===0?{success:!1,errors:["期首残高の明細がありません"]}:this.journalService.createJournal({date:e,description:"期首残高",details:i},{autoPost:!0})}exportCurrentBalancesAsOpeningDetails(){const e=[];for(const t of this.accountService.getAccounts())if(t.balance!==0){const i=t.isDebitBalance(),n=t.getDisplayBalance();e.push({accountCode:t.code,debitAmount:i?n:0,creditAmount:i?0:n})}return e}}class Se{constructor(){v(this,"unitOwners",[]);v(this,"vendors",[])}initializeUnitOwners(){this.unitOwners=[{unitNumber:"101",ownerName:"山田太郎",monthlyManagementFee:25e3,monthlyReserveFund:15e3,parkingFee:0,isActive:!0},{unitNumber:"102",ownerName:"佐藤花子",monthlyManagementFee:25e3,monthlyReserveFund:15e3,parkingFee:1e4,isActive:!0},{unitNumber:"201",ownerName:"鈴木一郎",monthlyManagementFee:3e4,monthlyReserveFund:18e3,parkingFee:1e4,isActive:!0},{unitNumber:"202",ownerName:"田中美咲",monthlyManagementFee:3e4,monthlyReserveFund:18e3,parkingFee:0,isActive:!0},{unitNumber:"301",ownerName:"高橋健太",monthlyManagementFee:35e3,monthlyReserveFund:21e3,parkingFee:1e4,isActive:!0},{unitNumber:"302",ownerName:"伊藤真理子",monthlyManagementFee:35e3,monthlyReserveFund:21e3,parkingFee:1e4,isActive:!0}]}initializeVendors(){this.vendors=[{code:"V001",name:"ABC管理サービス",category:"管理業務"},{code:"V002",name:"クリーンメンテナンス",category:"清掃業務"},{code:"V003",name:"東京電力",category:"水道光熱費"},{code:"V004",name:"東京水道局",category:"水道光熱費"},{code:"V005",name:"〇〇建設",category:"修繕工事"}]}createUnitOwnerAuxiliaryAccounts(e){const t=e.getAccount("1121"),i=e.getAccount("1122");if(t){t.hasAuxiliary=!0;for(const n of this.unitOwners)t.createAuxiliaryLedger(n.unitNumber,`${n.ownerName}様`,{owner:n})}if(i){i.hasAuxiliary=!0;for(const n of this.unitOwners)i.createAuxiliaryLedger(n.unitNumber,`${n.ownerName}様`,{owner:n})}}getUnitOwners(){return this.unitOwners}setUnitOwners(e){this.unitOwners=e}getVendors(){return this.vendors}setVendors(e){this.vendors=e}clearAuxiliaries(){this.unitOwners=[],this.vendors=[]}getAuxiliaryLedgerSummary(e){const t=[];for(const i of e.getAccounts())if(i.hasAuxiliary&&i.auxiliaryLedgers.size>0){const n=Array.from(i.auxiliaryLedgers.values()).map(o=>({code:o.auxiliaryCode,name:o.name,balance:o.getDisplayBalance(),isDebit:o.isDebitBalance()}));t.push({accountCode:i.code,accountName:i.name,auxiliaries:n})}return t}getUnitReceivablesSummary(e){const t=[],i=e.getAccount("1121"),n=e.getAccount("1122");for(const o of this.unitOwners){let r=0,s=0;if(i){const u=i.getAuxiliaryLedger(o.unitNumber);u&&(r=u.getDisplayBalance())}if(n){const u=n.getAuxiliaryLedger(o.unitNumber);u&&(s=u.getDisplayBalance())}const a=r+s;a!==0&&t.push({unitNumber:o.unitNumber,ownerName:o.ownerName,managementFeeReceivable:r,reserveFundReceivable:s,totalReceivable:a})}return t}createMonthlyBilling(e,t,i){const n=[];let o=0,r=0;for(const s of this.unitOwners)if(s.isActive){const a=s.monthlyManagementFee,u=s.monthlyReserveFund;a>0&&(n.push({accountCode:"1121",debitAmount:a,auxiliaryCode:s.unitNumber}),n.push({accountCode:"4110",creditAmount:a}),o+=a),u>0&&(n.push({accountCode:"1122",debitAmount:u,auxiliaryCode:s.unitNumber}),n.push({accountCode:"4210",creditAmount:u}),r+=u)}return o===0&&r===0?{success:!1,errors:["請求する金額がありません"]}:t.createJournal({date:e,description:"月次管理費・修繕積立金請求",details:n})}}class Z{constructor(e,t,i){this.journalService=e,this.accountService=t,this.auxiliaryService=i}clearAll(){this.accountService.clearAccounts(),this.journalService.clearJournals(),this.auxiliaryService.clearAuxiliaries()}loadSampleData(){this.loadOneMonthSampleData()}loadTwoYearSampleData(){this.loadFullYearSampleData()}getRandomAmount(e,t){return Math.floor(Math.random()*(t-e+1))+e}loadOneMonthSampleData(){this.loadFullYearSampleData()}loadFullYearSampleData(){this.accountService.clearAccounts(),this.journalService.clearJournals(),this.auxiliaryService.clearAuxiliaries(),this.accountService.initializeAccounts(),this.auxiliaryService.initializeUnitOwners(),this.auxiliaryService.initializeVendors(),this.auxiliaryService.createUnitOwnerAuxiliaryAccounts(this.accountService);const e=2024,t=this.journalService.createJournal({date:`${e}-04-01`,description:"期首残高（管理会計）",division:"KANRI",details:[{accountCode:"1102",debitAmount:5e6,creditAmount:0},{accountCode:"4101",debitAmount:0,creditAmount:5e6}]}),i=this.journalService.createJournal({date:`${e}-04-01`,description:"期首残高（修繕会計）",division:"SHUZEN",details:[{accountCode:"1103",debitAmount:1e7,creditAmount:0},{accountCode:"4102",debitAmount:0,creditAmount:1e7}]}),n=this.journalService.createJournal({date:`${e}-04-01`,description:"期首残高（駐車場会計）",division:"PARKING",details:[{accountCode:"1105",debitAmount:5e5,creditAmount:0},{accountCode:"4103",debitAmount:0,creditAmount:5e5}]});t.success&&t.data&&(this.journalService.submitJournal(t.data.id),this.journalService.approveJournal(t.data.id),this.journalService.postJournalById(t.data.id)),i.success&&i.data&&(this.journalService.submitJournal(i.data.id),this.journalService.approveJournal(i.data.id),this.journalService.postJournalById(i.data.id)),n.success&&n.data&&(this.journalService.submitJournal(n.data.id),this.journalService.approveJournal(n.data.id),this.journalService.postJournalById(n.data.id));for(let s=4;s<=12;s++)this.generateMonthlyTransactions(e,s);for(let s=1;s<=3;s++)this.generateMonthlyTransactions(e+1,s);this.generateAnnualTransactions(e),console.log("[SampleDataService] Posting all journals...");const o=this.journalService.getJournals();let r=0;for(const s of o)s.status==="DRAFT"&&this.journalService.submitJournal(s.id),(s.status==="SUBMITTED"||s.status==="DRAFT")&&this.journalService.approveJournal(s.id),s.status!=="POSTED"&&this.journalService.postJournalById(s.id)&&r++;console.log(`[SampleDataService] Posted ${r} journals out of ${o.length}`)}generateMonthlyTransactions(e,t){const i=String(t).padStart(2,"0"),n=new Date(e,t,0).getDate();this.journalService.createJournal({date:`${e}-${i}-25`,description:`管理費収入（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"1102",debitAmount:75e4,creditAmount:0},{accountCode:"5101",debitAmount:0,creditAmount:75e4}]}),this.journalService.createJournal({date:`${e}-${i}-25`,description:`修繕積立金収入（${e}年${t}月分）`,division:"SHUZEN",details:[{accountCode:"1103",debitAmount:5e5,creditAmount:0},{accountCode:"5201",debitAmount:0,creditAmount:5e5}]}),this.journalService.createJournal({date:`${e}-${i}-25`,description:`駐車場使用料（${e}年${t}月分）`,division:"PARKING",details:[{accountCode:"1105",debitAmount:24e4,creditAmount:0},{accountCode:"5107",debitAmount:0,creditAmount:24e4}]}),this.journalService.createJournal({date:`${e}-${i}-${n}`,description:`管理委託費（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"6101",debitAmount:35e4,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:35e4}]}),this.journalService.createJournal({date:`${e}-${i}-15`,description:`清掃業務委託費（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:8e4,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:8e4}]}),this.journalService.createJournal({date:`${e}-${i}-20`,description:`エレベーター保守点検（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:45e3,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:45e3}]}),this.journalService.createJournal({date:`${e}-${i}-10`,description:`共用部電気代（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"6102",debitAmount:35e3,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:35e3}]}),this.journalService.createJournal({date:`${e}-${i}-10`,description:`共用部水道代（${e}年${t}月分）`,division:"KANRI",details:[{accountCode:"6102",debitAmount:15e3,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:15e3}]}),this.journalService.createJournal({date:`${e}-${i}-${n}`,description:`駐車場管理費（${e}年${t}月分）`,division:"PARKING",details:[{accountCode:"6310",debitAmount:2e4,creditAmount:0},{accountCode:"1105",debitAmount:0,creditAmount:2e4}]}),this.journalService.createJournal({date:`${e}-${i}-05`,description:`自販機設置料（${e}年${t}月分）`,division:"OTHER",details:[{accountCode:"1102",debitAmount:5e3,creditAmount:0},{accountCode:"5302",debitAmount:0,creditAmount:5e3}]}),this.journalService.createJournal({date:`${e}-${i}-${n}`,description:`携帯基地局設置料（${e}年${t}月分）`,division:"OTHER",details:[{accountCode:"1102",debitAmount:3e4,creditAmount:0},{accountCode:"5302",debitAmount:0,creditAmount:3e4}]})}generateAnnualTransactions(e){this.journalService.createJournal({date:`${e}-06-15`,description:`マンション総合保険料（${e}年度）`,division:"KANRI",details:[{accountCode:"6104",debitAmount:18e4,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:18e4}]}),this.journalService.createJournal({date:`${e}-05-20`,description:`消防設備点検（${e}年度前期）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:6e4,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:6e4}]}),this.journalService.createJournal({date:`${e}-11-20`,description:`消防設備点検（${e}年度後期）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:6e4,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:6e4}]}),[6,9,12].forEach(n=>{this.journalService.createJournal({date:`${e}-${String(n).padStart(2,"0")}-10`,description:`植栽剪定作業（${e}年${n}月）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:45e3,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:45e3}]})}),this.journalService.createJournal({date:`${e+1}-03-10`,description:`植栽剪定作業（${e+1}年3月）`,division:"KANRI",details:[{accountCode:"6201",debitAmount:45e3,creditAmount:0},{accountCode:"1102",debitAmount:0,creditAmount:45e3}]}),this.journalService.createJournal({date:`${e}-09-30`,description:"外壁塗装工事（大規模修繕）",division:"SHUZEN",details:[{accountCode:"6401",debitAmount:3e6,creditAmount:0},{accountCode:"1103",debitAmount:0,creditAmount:3e6}]}),this.journalService.createJournal({date:`${e}-07-15`,description:"屋上防水補修工事",division:"SHUZEN",details:[{accountCode:"6401",debitAmount:8e5,creditAmount:0},{accountCode:"1103",debitAmount:0,creditAmount:8e5}]}),this.journalService.createJournal({date:`${e}-10-20`,description:"給水ポンプ交換工事",division:"SHUZEN",details:[{accountCode:"6401",debitAmount:5e5,creditAmount:0},{accountCode:"1103",debitAmount:0,creditAmount:5e5}]}),[4,5,6,7,9,10,11,12,1,2].forEach(n=>{const o=n<=3?e+1:e;this.journalService.createJournal({date:`${o}-${String(n).padStart(2,"0")}-15`,description:"集会室使用料",division:"OTHER",details:[{accountCode:"1101",debitAmount:3e3,creditAmount:0},{accountCode:"5302",debitAmount:0,creditAmount:3e3}]})})}}class X{constructor(e,t,i){this.accountService=e,this.journalService=t,this.divisionService=i}createClosingEntries(e){var i,n;const t=[];for(const o of this.divisionService.getDivisions()){if(!o.isRequired)continue;const r=o.code,s=[],a=[];let u=0,l=0;for(const m of this.accountService.getAccounts())if(m.division===r&&m.balance!==0){const S=m.getDisplayBalance();m.type==="REVENUE"?(s.push(m),u+=S):m.type==="EXPENSE"&&(a.push(m),l+=S)}if(u===0&&l===0){t.push({division:r,success:!0});continue}const p=[];for(const m of s)p.push({accountCode:m.code,debitAmount:m.getDisplayBalance()});for(const m of a)p.push({accountCode:m.code,creditAmount:m.getDisplayBalance()});const y=u-l,h=r===b.KANRI?"3110":r===b.SHUZEN?"3120":r===b.PARKING?"3130":null;h&&(y>0?p.push({accountCode:h,creditAmount:y}):y<0&&p.push({accountCode:h,debitAmount:Math.abs(y)}));const N=this.journalService.createJournal({date:e,description:`決算振替仕訳（${o.name}）`,details:p});N.success?t.push({division:r,success:!0,journalId:(i=N.data)==null?void 0:i.id}):t.push({division:r,success:!1,error:(n=N.errors)==null?void 0:n.join(", ")})}return t}}class ${constructor(e){v(this,"rules",[]);this.accountService=e,this.initializeDefaultRules()}initializeDefaultRules(){this.rules=[{id:"rule_income_unpaid",name:"収入取引（未決済）",condition:{transactionType:"income",paymentStatus:"unpaid"},journalPattern:{useTransactionAccount:"credit",requiresReceivable:!0},priority:100,isActive:!0},{id:"rule_income_paid",name:"収入取引（決済済み）",condition:{transactionType:"income",paymentStatus:"paid"},journalPattern:{usePaymentAccount:"debit",useTransactionAccount:"credit"},priority:100,isActive:!0},{id:"rule_expense_unpaid",name:"支出取引（未決済）",condition:{transactionType:"expense",paymentStatus:"unpaid"},journalPattern:{useTransactionAccount:"debit",creditAccountCode:"2101"},priority:100,isActive:!0},{id:"rule_expense_paid",name:"支出取引（決済済み）",condition:{transactionType:"expense",paymentStatus:"paid"},journalPattern:{useTransactionAccount:"debit",usePaymentAccount:"credit"},priority:100,isActive:!0},{id:"rule_transfer",name:"資金移動",condition:{transactionType:"transfer"},journalPattern:{useTransactionAccount:"debit",usePaymentAccount:"credit"},priority:100,isActive:!0}]}generateJournal(e){const t=this.findApplicableRule(e);if(!t)throw new Error(`取引タイプ ${e.type} に対する仕訳生成ルールが見つかりません`);const i=this.generateJournalDetails(e,t.journalPattern);return{date:e.occurredOn,description:this.generateDescription(e),reference:e.id,details:i}}findApplicableRule(e){return this.rules.filter(i=>i.isActive).filter(i=>this.matchesCondition(e,i.condition)).sort((i,n)=>n.priority-i.priority)[0]}matchesCondition(e,t){if(t.transactionType&&t.transactionType!==e.type||t.paymentStatus&&t.paymentStatus!==e.status||t.accountCode&&t.accountCode!==e.accountCode)return!1;if(t.amountRange){const{min:i,max:n}=t.amountRange;if(i!==void 0&&e.amount<i||n!==void 0&&e.amount>n)return!1}return!(t.tags&&t.tags.length>0&&(!e.tags||!t.tags.some(i=>{var n;return(n=e.tags)==null?void 0:n.includes(i)})))}generateJournalDetails(e,t){var r,s;const i=[];let n="";t.debitAccountCode?n=t.debitAccountCode:t.useTransactionAccount==="debit"?n=e.accountCode:t.usePaymentAccount==="debit"&&e.paymentAccountCode?n=e.paymentAccountCode:((r=t.useDefaultAccount)==null?void 0:r.position)==="debit"?n=t.useDefaultAccount.accountCode:t.requiresReceivable&&(n=this.getReceivableAccount(e));let o="";if(t.creditAccountCode?o=t.creditAccountCode:t.useTransactionAccount==="credit"?o=e.accountCode:t.usePaymentAccount==="credit"&&e.paymentAccountCode?o=e.paymentAccountCode:((s=t.useDefaultAccount)==null?void 0:s.position)==="credit"&&(o=t.useDefaultAccount.accountCode),!this.accountService.getAccount(n))throw new Error(`借方勘定科目 ${n} が見つかりません`);if(!this.accountService.getAccount(o))throw new Error(`貸方勘定科目 ${o} が見つかりません`);return i.push({accountCode:n,debitAmount:e.amount,creditAmount:0,description:e.note}),i.push({accountCode:o,debitAmount:0,creditAmount:e.amount,description:e.note}),i}getReceivableAccount(e){const t=this.accountService.getAccount(e.accountCode);return!t||t.code.startsWith("51")?"1301":t.code.startsWith("52")?"1302":t.code.startsWith("53")?"1303":"1301"}generateDescription(e){let t="";switch(e.type){case"income":const i=this.accountService.getAccount(e.accountCode);t=i?`${i.name}`:"収入取引";break;case"expense":const n=this.accountService.getAccount(e.accountCode);t=n?`${n.name}`:"支出取引";break;case"transfer":const o=e.paymentAccountCode?this.accountService.getAccount(e.paymentAccountCode):null,r=this.accountService.getAccount(e.accountCode);o&&r?t=`資金移動: ${o.name} → ${r.name}`:t="資金移動";break}return e.note&&(t+=` - ${e.note}`),t}addRule(e){this.rules.push(e),this.rules.sort((t,i)=>i.priority-t.priority)}removeRule(e){this.rules=this.rules.filter(t=>t.id!==e)}updateRule(e,t){const i=this.rules.findIndex(n=>n.id===e);i!==-1&&(this.rules[i]={...this.rules[i],...t},this.rules.sort((n,o)=>o.priority-n.priority))}getRules(){return[...this.rules]}generatePaymentJournal(e,t){const i=[];if(e.type==="income"){const n=this.getReceivableAccount(e);i.push({accountCode:t,debitAmount:e.amount,creditAmount:0,description:`決済: ${e.note||""}`}),i.push({accountCode:n,debitAmount:0,creditAmount:e.amount,description:`決済: ${e.note||""}`})}else e.type==="expense"&&(i.push({accountCode:"2101",debitAmount:e.amount,creditAmount:0,description:`決済: ${e.note||""}`}),i.push({accountCode:t,debitAmount:0,creditAmount:e.amount,description:`決済: ${e.note||""}`}));return{date:new Date().toISOString().split("T")[0],description:`決済処理: ${this.generateDescription(e)}`,reference:`payment_${e.id}`,details:i}}}class q{constructor(e,t,i){v(this,"transactions",[]);v(this,"counterparties",[]);v(this,"templates",[]);v(this,"journalGenerationEngine");v(this,"bankAccountService",null);this.accountService=e,this.journalService=t,this.journalGenerationEngine=new $(e),this.bankAccountService=i||null,this.initializeDefaultData()}setBankAccountService(e){this.bankAccountService=e}initializeDefaultData(){this.counterparties=[{id:"cp_001",name:"管理会社A",code:"KANRI_A",paymentTerms:{type:"end_of_month",description:"月末締め翌月末払い"},isActive:!0},{id:"cp_002",name:"清掃業者B",code:"SEISO_B",paymentTerms:{type:"immediate",description:"即日払い"},isActive:!0},{id:"cp_003",name:"電力会社",code:"DENRYOKU",paymentTerms:{type:"custom",customDays:20,description:"20日後払い"},isActive:!0}],this.templates=[{id:"tpl_001",name:"管理費収入",description:"毎月の管理費収入",type:"income",accountCode:"4111",tags:["定期","管理費"],isActive:!0},{id:"tpl_002",name:"電気代支払",description:"共用部電気代",type:"expense",accountCode:"5131",counterpartyId:"cp_003",tags:["定期","光熱費"],isActive:!0},{id:"tpl_003",name:"清掃費支払",description:"定期清掃費用",type:"expense",accountCode:"5121",counterpartyId:"cp_002",tags:["定期","清掃"],isActive:!0}]}createTransaction(e){var n;const t=this.validateTransaction(e);if(!t.isValid)return{success:!1,errors:t.errors};if(e.paymentAccountCode&&this.bankAccountService){const o=this.bankAccountService.getAccount(e.paymentAccountCode);if(!o)return{success:!1,errors:[`決済口座 ${e.paymentAccountCode} が見つかりません`]};if(!o.isActive)return{success:!1,errors:[`決済口座 ${o.name} は無効化されています`]}}const i={id:`t_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,createdAt:new Date};try{const o=this.journalGenerationEngine.generateJournal(i),r=this.journalService.createJournal(o,{autoPost:e.status==="paid",meta:{transactionId:i.id}});return r.success?(i.journalId=(n=r.data)==null?void 0:n.id,this.transactions.push(i),this.bankAccountService&&(e.paymentAccountCode&&this.bankAccountService.registerTransactionReference(i.id,e.paymentAccountCode,!1),e.type==="transfer"&&e.accountCode&&this.bankAccountService.registerTransactionReference(i.id,e.accountCode,!0)),{success:!0,journal:r.data,data:i}):r}catch(o){return{success:!1,errors:[o instanceof Error?o.message:"取引作成エラー"]}}}validateTransaction(e){const t=[];if(e.divisionCode||t.push("会計区分は必須です"),e.occurredOn||t.push("発生日は必須です"),!e.accountCode)t.push("勘定科目は必須です");else{const i=this.accountService.getAccount(e.accountCode);i?i.isActive||t.push(`勘定科目 ${e.accountCode} は無効です`):t.push(`勘定科目 ${e.accountCode} が見つかりません`)}if((!e.amount||e.amount<=0)&&t.push("金額は0より大きい値を入力してください"),e.status==="paid"&&!e.paymentAccountCode&&t.push("決済済みの場合は決済口座を選択してください"),e.type==="transfer"&&(e.paymentAccountCode||t.push("資金移動の場合は移動元口座を選択してください"),e.accountCode===e.paymentAccountCode&&t.push("移動元と移動先は異なる口座を選択してください")),e.dueOn&&e.occurredOn){const i=new Date(e.occurredOn);new Date(e.dueOn)<i&&t.push("決済期日は発生日以降の日付を設定してください")}return{isValid:t.length===0,errors:t.length>0?t:void 0}}updateTransaction(e,t){var s;const i=this.transactions.findIndex(a=>a.id===e);if(i===-1)return{success:!1,errors:["取引が見つかりません"]};const n=this.transactions[i];if(!n)return{success:!1,errors:["取引が見つかりません"]};const o={...n,...t,updatedAt:new Date},r=this.validateTransaction(o);if(!r.isValid)return{success:!1,errors:r.errors};try{n.journalId&&this.journalService.deleteJournal(n.journalId);const a=this.journalGenerationEngine.generateJournal(o),u=this.journalService.createJournal(a,{autoPost:o.status==="paid",meta:{transactionId:o.id}});return u.success?(o.journalId=(s=u.data)==null?void 0:s.id,this.transactions[i]=o,{success:!0,data:o}):u}catch(a){return{success:!1,errors:[a instanceof Error?a.message:"取引更新エラー"]}}}deleteTransaction(e){const t=this.transactions.findIndex(n=>n.id===e);if(t===-1)return{success:!1,errors:["取引が見つかりません"]};const i=this.transactions[t];if(!i)return{success:!1,errors:["取引が見つかりません"]};if(i.journalId){const n=this.journalService.deleteJournal(i.journalId);if(!n.success)return n}return this.transactions.splice(t,1),{success:!0}}settleTransaction(e,t){const i=this.transactions.find(n=>n.id===e);if(!i)return{success:!1,errors:["取引が見つかりません"]};if(i.status==="paid")return{success:!1,errors:["既に決済済みです"]};if(i.type==="transfer")return{success:!1,errors:["資金移動は決済処理できません"]};try{const n=this.journalGenerationEngine.generatePaymentJournal(i,t),o=this.journalService.createJournal(n,{autoPost:!0,meta:{transactionId:i.id,type:"payment"}});return o.success?(i.status="paid",i.paymentAccountCode=t,i.updatedAt=new Date,{success:!0,data:i}):o}catch(n){return{success:!1,errors:[n instanceof Error?n.message:"決済処理エラー"]}}}searchTransactions(e){let t=[...this.transactions];return e.type&&e.type.length>0&&(t=t.filter(i=>{var n;return(n=e.type)==null?void 0:n.includes(i.type)})),e.status&&e.status.length>0&&(t=t.filter(i=>{var n;return(n=e.status)==null?void 0:n.includes(i.status)})),e.accountCodes&&e.accountCodes.length>0&&(t=t.filter(i=>{var n;return(n=e.accountCodes)==null?void 0:n.includes(i.accountCode)})),e.counterpartyIds&&e.counterpartyIds.length>0&&(t=t.filter(i=>{var n;return i.counterpartyId&&((n=e.counterpartyIds)==null?void 0:n.includes(i.counterpartyId))})),e.dateFrom&&(t=t.filter(i=>i.occurredOn>=e.dateFrom)),e.dateTo&&(t=t.filter(i=>i.occurredOn<=e.dateTo)),e.amountMin!==void 0&&(t=t.filter(i=>i.amount>=e.amountMin)),e.amountMax!==void 0&&(t=t.filter(i=>i.amount<=e.amountMax)),e.tags&&e.tags.length>0&&(t=t.filter(i=>{var n;return i.tags&&((n=e.tags)==null?void 0:n.some(o=>{var r;return(r=i.tags)==null?void 0:r.includes(o)}))})),e.hasJournal!==void 0&&(t=t.filter(i=>e.hasJournal?!!i.journalId:!i.journalId)),t.sort((i,n)=>n.occurredOn.localeCompare(i.occurredOn)),t}getTransactionSummary(e,t){const i=this.searchTransactions({dateFrom:e,dateTo:t}),n={totalIncome:0,totalExpense:0,totalTransfer:0,unpaidIncome:0,unpaidExpense:0,periodFrom:e,periodTo:t,byAccount:[],byCounterparty:[]},o=new Map,r=new Map;return i.forEach(s=>{switch(s.type){case"income":n.totalIncome+=s.amount,s.status==="unpaid"&&(n.unpaidIncome+=s.amount);break;case"expense":n.totalExpense+=s.amount,s.status==="unpaid"&&(n.unpaidExpense+=s.amount);break;case"transfer":n.totalTransfer+=s.amount;break}const a=this.accountService.getAccount(s.accountCode);if(a){const u=o.get(s.accountCode)||{name:a.name,amount:0,count:0};u.amount+=s.amount,u.count+=1,o.set(s.accountCode,u)}if(s.counterpartyId){const u=this.counterparties.find(l=>l.id===s.counterpartyId);if(u){const l=r.get(s.counterpartyId)||{name:u.name,amount:0,count:0};l.amount+=s.amount,l.count+=1,r.set(s.counterpartyId,l)}}}),n.byAccount=Array.from(o.entries()).map(([s,a])=>({accountCode:s,accountName:a.name,amount:a.amount,count:a.count})).sort((s,a)=>a.amount-s.amount),n.byCounterparty=Array.from(r.entries()).map(([s,a])=>({counterpartyId:s,counterpartyName:a.name,amount:a.amount,count:a.count})).sort((s,a)=>a.amount-s.amount),n}getCounterparties(){return[...this.counterparties]}addCounterparty(e){this.counterparties.push(e)}updateCounterparty(e,t){const i=this.counterparties.findIndex(n=>n.id===e);i!==-1&&(this.counterparties[i]={...this.counterparties[i],...t})}getTemplates(){return[...this.templates]}getTemplate(e){return this.templates.find(t=>t.id===e)}createTransactionFromTemplate(e,t){const i=this.templates.find(o=>o.id===e);if(!i)return{success:!1,errors:["テンプレートが見つかりません"]};const n={type:i.type,occurredOn:new Date().toISOString().split("T")[0],accountCode:i.accountCode,amount:i.defaultAmount||0,status:"unpaid",counterpartyId:i.counterpartyId,tags:i.tags,taxCategory:i.taxCategory,...t};return this.createTransaction(n)}getTransactions(){return[...this.transactions]}clearTransactions(){this.transactions=[]}}const x=class x{constructor(){v(this,"container",null)}static getInstance(){return x.instance||(x.instance=new x),x.instance}createServices(){const e=new D,t=new z,i=new Se,n=new _(e,t),o=new Y(e,n,t),r=new G(e,n,t,i),s=new Z(n,e,i),a=new X(e,n,t),u=new $(e),l=new q(e,n);return{accountService:e,journalService:n,divisionService:t,reportService:o,importExportService:r,auxiliaryService:i,sampleDataService:s,closingService:a,transactionService:l,journalGenerationEngine:u}}getContainer(){return this.container||(this.container=this.createServices()),this.container}resetContainer(){this.container=null}static createAccountService(){return new D}static createJournalService(e,t){return new _(e,t)}static createDivisionService(){return new z}static createReportService(e,t,i){return new Y(e,t,i)}static createTransactionService(e,t,i){return new q(e,t,i)}static createJournalGenerationEngine(e){return new $(e)}static createImportExportService(e,t,i,n){return new G(e,t,i,n)}static createClosingService(e,t,i){return new X(e,t,i)}static createSampleDataService(e,t,i){return new Z(e,t,i)}};v(x,"instance",null);let k=x;class be{constructor(e){v(this,"services");const t=e||k.getInstance();this.services=t.createServices(),this.initializeEngine()}initializeEngine(){this.services.accountService.initializeAccounts(),this.services.divisionService.initializeDivisions(),this.services.auxiliaryService.initializeUnitOwners(),this.services.auxiliaryService.initializeVendors(),this.services.accountService instanceof D&&this.services.auxiliaryService.createUnitOwnerAuxiliaryAccounts(this.services.accountService),this.services.sampleDataService.loadOneMonthSampleData()}get accounts(){return this.services.accountService.accounts}get divisions(){return this.services.divisionService.divisions}initializeAccounts(){return this.services.accountService.initializeAccounts()}rebuildAccountsFrom(e){if(this.services.accountService instanceof D)return this.services.accountService.rebuildAccountsFrom(e);throw new Error("rebuildAccountsFrom requires AccountService implementation")}addOrUpdateAccount(e){if(this.services.accountService instanceof D)return this.services.accountService.addOrUpdateAccount(e);throw new Error("addOrUpdateAccount requires AccountService implementation")}setAccountActive(e,t){if(this.services.accountService instanceof D)return this.services.accountService.setAccountActive(e,t);throw new Error("setAccountActive requires AccountService implementation")}getAccounts(){return this.services.accountService.getAccounts()}get journals(){return this.services.journalService.getJournals()}createJournal(e,t){return this.services.journalService.createJournal(e,t)}submitJournal(e){return this.services.journalService.submitJournal?this.services.journalService.submitJournal(e):{success:!1,errors:["Method not implemented"]}}approveJournal(e){return this.services.journalService.approveJournal?this.services.journalService.approveJournal(e):{success:!1,errors:["Method not implemented"]}}postJournalById(e){return this.services.journalService.postJournalById?this.services.journalService.postJournalById(e):{success:!1,errors:["Method not implemented"]}}deleteJournal(e){return this.services.journalService.deleteJournal?this.services.journalService.deleteJournal(e):{success:!1,errors:["Method not implemented"]}}updateJournal(e,t){return this.services.journalService.updateJournal?this.services.journalService.updateJournal(e,t):{success:!1,errors:["Method not implemented"]}}initializeDivisions(){return this.services.divisionService.initializeDivisions()}get unitOwners(){return this.services.auxiliaryService.getUnitOwners()}set unitOwners(e){this.services.auxiliaryService.setUnitOwners(e)}get vendors(){return this.services.auxiliaryService.getVendors()}set vendors(e){this.services.auxiliaryService.setVendors(e)}initializeUnitOwners(){return this.services.auxiliaryService.initializeUnitOwners()}initializeVendors(){return this.services.auxiliaryService.initializeVendors()}createUnitOwnerAuxiliaryAccounts(){return this.services.auxiliaryService.createUnitOwnerAuxiliaryAccounts(this.services.accountService)}getAuxiliaryLedgerSummary(){if(this.services.accountService instanceof D)return this.services.auxiliaryService.getAuxiliaryLedgerSummary(this.services.accountService);throw new Error("getAuxiliaryLedgerSummary requires AccountService implementation")}getUnitReceivablesSummary(){if(this.services.accountService instanceof D)return this.services.auxiliaryService.getUnitReceivablesSummary(this.services.accountService);throw new Error("getUnitReceivablesSummary requires AccountService implementation")}createMonthlyBilling(e){if(this.services.journalService instanceof _&&this.services.accountService instanceof D)return this.services.auxiliaryService.createMonthlyBilling(e,this.services.journalService,this.services.accountService);throw new Error("createMonthlyBilling requires concrete service implementations")}getTrialBalance(){return this.services.reportService.getTrialBalance()}getIncomeStatement(){return this.services.reportService.getIncomeStatement()}getBalanceSheet(){return this.services.reportService.getBalanceSheet()}getBalanceSheetDebugInfo(){return this.services.reportService.getBalanceSheetDebugInfo()}getDivisionTrialBalance(){return this.services.reportService.getDivisionTrialBalance()}getIncomeDetails(e,t,i){return this.services.reportService.getIncomeDetails(e,t,i)}getIncomeDetailSummary(e,t,i){return this.services.reportService.getIncomeDetailSummary(e,t,i)}getExpenseDetails(e,t,i){return this.services.reportService.getExpenseDetails(e,t,i)}getExpenseDetailSummary(e,t,i){return this.services.reportService.getExpenseDetailSummary(e,t,i)}serialize(){return this.services.importExportService.serialize()}restore(e){return this.services.importExportService.restore(e)}importJsonData(e){return this.services.importExportService.importJsonData(e)}createOpeningBalance(e,t){return this.services.importExportService.createOpeningBalance(e,t)}exportCurrentBalancesAsOpeningDetails(){return this.services.importExportService.exportCurrentBalancesAsOpeningDetails()}get sampleDataService(){return this.services.sampleDataService}loadTwoYearSampleData(){return this.services.sampleDataService.loadTwoYearSampleData()}loadOneMonthSampleData(){return this.services.sampleDataService.loadOneMonthSampleData()}loadSampleData(){return this.services.sampleDataService.loadSampleData()}clearAll(){return this.services.sampleDataService.clearAll()}rebuildAuxiliaryAccounts(){if(this.services.accountService instanceof D)return this.services.accountService.rebuildAuxiliaryAccounts();throw new Error("rebuildAuxiliaryAccounts requires AccountService implementation")}createClosingEntries(e){return this.services.closingService.createClosingEntries(e)}postJournal(e){if(this.services.journalService instanceof _)return this.services.journalService.postJournal(e);throw new Error("postJournal requires JournalService implementation")}validateDivisionAccounting(e){if(this.services.journalService instanceof _)return this.services.journalService.validateDivisionAccounting(e);throw new Error("validateDivisionAccounting requires JournalService implementation")}getChartOfAccounts(){return this.getAccounts().map(e=>({code:e.code,name:e.name,type:e.type,normalBalance:e.normalBalance,division:e.division,parentCode:e.parentCode,description:e.description,isActive:e.isActive,level:"level"in e?e.level:0,isPostable:"isPostable"in e?e.isPostable:!0}))}getTransactionService(){return this.services.transactionService}getJournalGenerationEngine(){return this.services.journalGenerationEngine}getAccountService(){return this.services.accountService}createTransaction(e){return this.services.transactionService.createTransaction(e)}getTransactions(){return this.services.transactionService.getTransactions()}searchTransactions(e){return this.services.transactionService.searchTransactions(e)}settleTransaction(e,t){return this.services.transactionService.settleTransaction(e,t)}getCounterparties(){return this.services.transactionService.getCounterparties()}getTransactionTemplates(){return this.services.transactionService.getTemplates()}}const Q={BASE_URL:"/account/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},P=new Map,B=c=>{const e=P.get(c);return e?Object.fromEntries(Object.entries(e.stores).map(([t,i])=>[t,i.getState()])):{}},Ee=(c,e,t)=>{if(c===void 0)return{type:"untracked",connection:e.connect(t)};const i=P.get(t.name);if(i)return{type:"tracked",store:c,...i};const n={connection:e.connect(t),stores:{}};return P.set(t.name,n),{type:"tracked",store:c,...n}},Te=(c,e)=>{if(e===void 0)return;const t=P.get(c);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&P.delete(c))},Ne=c=>{var e,t;if(!c)return;const i=c.split(`
`),n=i.findIndex(r=>r.includes("api.setState"));if(n<0)return;const o=((e=i[n+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(o))==null?void 0:t[1]},Ie=(c,e={})=>(t,i,n)=>{const{enabled:o,anonymousActionType:r,store:s,...a}=e;let u;try{u=(o??(Q?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return c(t,i,n);const{connection:l,...p}=Ee(s,u,a);let y=!0;n.setState=(m,S,A)=>{const g=t(m,S);if(!y)return g;const I=A===void 0?{type:r||Ne(new Error().stack)||"anonymous"}:typeof A=="string"?{type:A}:A;return s===void 0?(l==null||l.send(I,i()),g):(l==null||l.send({...I,type:`${s}/${I.type}`},{...B(a.name),[s]:n.getState()}),g)},n.devtools={cleanup:()=>{l&&typeof l.unsubscribe=="function"&&l.unsubscribe(),Te(a.name,s)}};const h=(...m)=>{const S=y;y=!1,t(...m),y=S},N=c(n.setState,i,n);if(p.type==="untracked"?l==null||l.init(N):(p.stores[p.store]=n,l==null||l.init(Object.fromEntries(Object.entries(p.stores).map(([m,S])=>[m,m===p.store?N:S.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let m=!1;const S=n.dispatch;n.dispatch=(...A)=>{(Q?"production":void 0)!=="production"&&A[0].type==="__setState"&&!m&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),m=!0),S(...A)}}return l.subscribe(m=>{var S;switch(m.type){case"ACTION":if(typeof m.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return J(m.payload,A=>{if(A.type==="__setState"){if(s===void 0){h(A.state);return}Object.keys(A.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const g=A.state[s];if(g==null)return;JSON.stringify(n.getState())!==JSON.stringify(g)&&h(g);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(A)});case"DISPATCH":switch(m.payload.type){case"RESET":return h(N),s===void 0?l==null?void 0:l.init(n.getState()):l==null?void 0:l.init(B(a.name));case"COMMIT":if(s===void 0){l==null||l.init(n.getState());return}return l==null?void 0:l.init(B(a.name));case"ROLLBACK":return J(m.state,A=>{if(s===void 0){h(A),l==null||l.init(n.getState());return}h(A[s]),l==null||l.init(B(a.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return J(m.state,A=>{if(s===void 0){h(A);return}JSON.stringify(n.getState())!==JSON.stringify(A[s])&&h(A[s])});case"IMPORT_STATE":{const{nextLiftedState:A}=m.payload,g=(S=A.computedStates.slice(-1)[0])==null?void 0:S.state;if(!g)return;h(s===void 0?g:g[s]),l==null||l.send(null,A);return}case"PAUSE_RECORDING":return y=!y}return}}),N},De=Ie,J=(c,e)=>{let t;try{t=JSON.parse(c)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}t!==void 0&&e(t)},Oe=c=>(e,t,i)=>{const n=i.subscribe;return i.subscribe=(r,s,a)=>{let u=r;if(s){const l=(a==null?void 0:a.equalityFn)||Object.is;let p=r(i.getState());u=y=>{const h=r(y);if(!l(p,h)){const N=p;s(p=h,N)}},a!=null&&a.fireImmediately&&s(p,p)}return n(u)},c(e,t,i)},Vt=Oe;function xe(c,e){let t;try{t=c()}catch{return}return{getItem:n=>{var o;const r=a=>a===null?null:JSON.parse(a,void 0),s=(o=t.getItem(n))!=null?o:null;return s instanceof Promise?s.then(r):r(s)},setItem:(n,o)=>t.setItem(n,JSON.stringify(o,void 0)),removeItem:n=>t.removeItem(n)}}const K=c=>e=>{try{const t=c(e);return t instanceof Promise?t:{then(i){return K(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return K(i)(t)}}}},Re=(c,e)=>(t,i,n)=>{let o={storage:xe(()=>localStorage),partialize:m=>m,version:0,merge:(m,S)=>({...S,...m}),...e},r=!1;const s=new Set,a=new Set;let u=o.storage;if(!u)return c((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),t(...m)},i,n);const l=()=>{const m=o.partialize({...i()});return u.setItem(o.name,{state:m,version:o.version})},p=n.setState;n.setState=(m,S)=>(p(m,S),l());const y=c((...m)=>(t(...m),l()),i,n);n.getInitialState=()=>y;let h;const N=()=>{var m,S;if(!u)return;r=!1,s.forEach(g=>{var I;return g((I=i())!=null?I:y)});const A=((S=o.onRehydrateStorage)==null?void 0:S.call(o,(m=i())!=null?m:y))||void 0;return K(u.getItem.bind(u))(o.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==o.version){if(o.migrate){const I=o.migrate(g.state,g.version);return I instanceof Promise?I.then(L=>[!0,L]):[!0,I]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var I;const[L,se]=g;if(h=o.merge(se,(I=i())!=null?I:y),t(h,!0),L)return l()}).then(()=>{A==null||A(h,void 0),h=i(),r=!0,a.forEach(g=>g(h))}).catch(g=>{A==null||A(void 0,g)})};return n.persist={setOptions:m=>{o={...o,...m},m.storage&&(u=m.storage)},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>N(),hasHydrated:()=>r,onHydrate:m=>(s.add(m),()=>{s.delete(m)}),onFinishHydration:m=>(a.add(m),()=>{a.delete(m)})},o.skipHydration||N(),h||y},Ht=Re,V=de()(De(c=>({activeMenu:"freeeInput",sidebarOpen:!0,mobileMenuOpen:!1,setActiveMenu:e=>c({activeMenu:e}),toggleSidebar:()=>c(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:e=>c({sidebarOpen:e}),toggleMobileMenu:()=>c(e=>({mobileMenuOpen:!e.mobileMenuOpen})),setMobileMenuOpen:e=>c({mobileMenuOpen:e})}),{name:"navigation-store"})),_e="_sidebar_1e6ef_2",Pe="_desktop_1e6ef_13",je="_collapsed_1e6ef_17",we="_mobile_1e6ef_21",Be="_open_1e6ef_31",Me="_overlay_1e6ef_36",Le="_header_1e6ef_47",Je="_title_1e6ef_55",Ue="_hidden_1e6ef_63",$e="_toggleButton_1e6ef_68",ke="_closeButton_1e6ef_69",Ke="_nav_1e6ef_85",Ve="_menuGroup_1e6ef_89",He="_menuItem_1e6ef_93",Fe="_menuItemContent_1e6ef_112",ze="_menuIcon_1e6ef_118",Ye="_menuLabel_1e6ef_124",Ge="_chevron_1e6ef_128",Ze="_rotated_1e6ef_133",Xe="_submenu_1e6ef_138",qe="_submenuItem_1e6ef_155",Qe="_active_1e6ef_175",C={sidebar:_e,desktop:Pe,collapsed:je,mobile:we,open:Be,overlay:Me,header:Le,title:Je,hidden:Ue,toggleButton:$e,closeButton:ke,nav:Ke,menuGroup:Ve,menuItem:He,menuItemContent:Fe,menuIcon:ze,menuLabel:Ye,chevron:Ge,rotated:Ze,submenu:Xe,submenuItem:qe,active:Qe},We=({isOpen:c,isMobile:e=!1,onToggle:t,onClose:i})=>d.jsxs("div",{className:C.header,children:[d.jsx("h5",{className:`${C.title} ${!c&&!e?C.hidden:""}`,children:"会計システム"}),e?d.jsx("button",{onClick:i,className:C.closeButton,"aria-label":"メニューを閉じる",children:"×"}):d.jsx("button",{onClick:t,className:C.toggleButton,"aria-label":c?"サイドバーを閉じる":"サイドバーを開く",children:c?"◀":"▶"})]}),et=[{id:"journal",label:"仕訳管理",icon:"📝",children:[{id:"freeeInput",label:"かんたん入力",icon:"🌟"},{id:"bankImport",label:"銀行明細インポート",icon:"🤖"},{id:"auxiliary",label:"補助元帳",icon:"📚"}]},{id:"reports",label:"帳票・レポート",icon:"📊",children:[{id:"incomeDetail",label:"収入明細表",icon:"💰"},{id:"expenseDetail",label:"支出明細表",icon:"💸"},{id:"report",label:"収支報告書（区分別）",icon:"📈"},{id:"divisionStatements",label:"試算表/PL/BS",icon:"📑"}]},{id:"system",label:"システム管理",icon:"⚙️",children:[{id:"chart",label:"科目マスタ",icon:"📋"},{id:"bankAccounts",label:"口座管理",icon:"🏦"},{id:"settings",label:"設定・期首",icon:"🔧"},{id:"closing",label:"期末処理",icon:"🔒"}]},{id:"data",label:"データ管理",icon:"💾",children:[{id:"sampleData",label:"サンプルデータ",icon:"🏢"},{id:"export",label:"バックアップ/CSV",icon:"📤"},{id:"spec",label:"JSON仕様",icon:"📄"},{id:"paymentTest",label:"Phase14テスト",icon:"🧪"}]},{id:"help",label:"ヘルプ",icon:"❓",children:[{id:"manual",label:"マニュアル",icon:"📚"}]}],tt=({isOpen:c,isMobile:e=!1})=>{const{activeMenu:t,setActiveMenu:i}=V(),[n,o]=f.useState({journal:!0}),r=a=>{o(u=>({...u,[a]:!u[a]}))},s=a=>{i(a)};return d.jsx("nav",{className:C.nav,children:et.map(a=>d.jsxs("div",{className:C.menuGroup,children:[d.jsxs("button",{onClick:()=>r(a.id),className:C.menuItem,"aria-expanded":n[a.id],children:[d.jsxs("span",{className:C.menuItemContent,children:[d.jsx("span",{className:C.menuIcon,children:a.icon}),(c||e)&&d.jsx("span",{className:C.menuLabel,children:a.label})]}),(c||e)&&a.children&&d.jsx("span",{className:`${C.chevron} ${n[a.id]?C.rotated:""}`,children:"▶"})]}),(c||e)&&n[a.id]&&a.children&&d.jsx("div",{className:C.submenu,children:a.children.map(u=>d.jsxs("button",{onClick:()=>s(u.id),className:`
                    ${C.submenuItem} 
                    ${t===u.id?C.active:""}
                  `,children:[d.jsx("span",{className:C.menuIcon,children:u.icon}),d.jsx("span",{className:C.menuLabel,children:u.label})]},u.id))})]},a.id))})},W=({isOpen:c,isMobile:e=!1,onToggle:t,onClose:i})=>d.jsxs(d.Fragment,{children:[e&&c&&d.jsx("div",{className:C.overlay,onClick:i}),d.jsxs("aside",{className:`
          ${C.sidebar} 
          ${c?C.open:C.collapsed}
          ${e?C.mobile:C.desktop}
        `,children:[d.jsx(We,{isOpen:c,isMobile:e,onToggle:t,onClose:i}),d.jsx(tt,{isOpen:c,isMobile:e})]})]}),it="_themeSwitcher_j39ku_1",nt="_button_j39ku_6",ot="_active_j39ku_17",O={themeSwitcher:it,button:nt,active:ot},rt=()=>{const[c,e]=f.useState(()=>localStorage.getItem("theme")||"auto");return f.useEffect(()=>{if((i=>{const n=document.documentElement;i==="light"?n.setAttribute("data-theme","light"):i==="dark"?n.setAttribute("data-theme","dark"):n.removeAttribute("data-theme"),document.body.classList.remove("theme-light","theme-dark","theme-auto"),document.body.classList.add(`theme-${i}`)})(c),localStorage.setItem("theme",c),c==="auto"){const i=window.matchMedia("(prefers-color-scheme: dark)"),n=()=>{const o=i.matches;console.log(`System theme changed: ${o?"dark":"light"}`)};return i.addEventListener("change",n),()=>i.removeEventListener("change",n)}},[c]),d.jsxs("div",{className:O.themeSwitcher,children:[d.jsx("button",{className:`${O.button} ${c==="light"?O.active:""}`,onClick:()=>e("light"),title:"ライトテーマ",children:"☀️"}),d.jsx("button",{className:`${O.button} ${c==="dark"?O.active:""}`,onClick:()=>e("dark"),title:"ダークテーマ",children:"🌙"}),d.jsx("button",{className:`${O.button} ${c==="auto"?O.active:""}`,onClick:()=>e("auto"),title:"自動（システム設定に従う）",children:"🔄"})]})},st="_layout_49489_2",at="_mobileMenuButton_49489_10",ct="_mainContent_49489_31",ut="_header_49489_39",lt="_title_49489_49",dt="_content_49489_56",R={layout:st,mobileMenuButton:at,mainContent:ct,header:ut,title:lt,content:dt},mt=({children:c,title:e="マンション管理組合会計エンジン"})=>{const{sidebarOpen:t,mobileMenuOpen:i,toggleSidebar:n,setMobileMenuOpen:o}=V();f.useEffect(()=>{const s=()=>{window.innerWidth>768&&o(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[o]);const r=window.innerWidth<=768;return d.jsxs("div",{className:R.layout,children:[r&&d.jsx("button",{className:R.mobileMenuButton,onClick:()=>o(!0),"aria-label":"メニューを開く",children:"☰"}),r?d.jsx(W,{isOpen:i,isMobile:!0,onToggle:()=>o(!i),onClose:()=>o(!1)}):d.jsx(W,{isOpen:t,isMobile:!1,onToggle:n}),d.jsxs("div",{className:R.mainContent,children:[d.jsxs("header",{className:R.header,children:[d.jsx("h1",{className:R.title,children:e}),d.jsx(rt,{})]}),d.jsx("main",{className:R.content,children:c})]})]})},pt="modulepreload",vt=function(c){return"/account/"+c},ee={},E=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),s=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=Promise.allSettled(t.map(a=>{if(a=vt(a),a in ee)return;ee[a]=!0;const u=a.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${l}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":pt,u||(p.as="script"),p.crossOrigin="",p.href=a,s&&p.setAttribute("nonce",s),document.head.appendChild(p),u)return new Promise((y,h)=>{p.addEventListener("load",y),p.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(r){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=r,window.dispatchEvent(s),!s.defaultPrevented)throw r}return n.then(r=>{for(const s of r||[])s.status==="rejected"&&o(s.reason);return e().catch(o)})},ht=f.lazy(()=>E(()=>import("../FreeeStyleJournalForm.tsx-54MbtbaE.js"),__vite__mapDeps([0,1,2,3,4]))),yt=f.lazy(()=>E(()=>import("../BankImportWizard.tsx-BB5uTOD2.js"),__vite__mapDeps([5,1,6,3])).then(c=>({default:c.BankImportWizard}))),ft=f.lazy(()=>E(()=>import("../AuxiliaryLedgerView.tsx-gInRy3Xf.js"),__vite__mapDeps([7,1,3])).then(c=>({default:c.AuxiliaryLedgerView}))),At=f.lazy(()=>E(()=>import("../IncomeDetailView.tsx-BSbSVmjC.js"),__vite__mapDeps([8,1,9,3])).then(c=>({default:c.IncomeDetailView}))),gt=f.lazy(()=>E(()=>import("../ExpenseDetailView.tsx-DwY2w0Mz.js"),__vite__mapDeps([10,1,9,3])).then(c=>({default:c.ExpenseDetailView}))),Ct=f.lazy(()=>E(()=>import("../IncomeExpenseReport.tsx-CQf6jjWZ.js"),__vite__mapDeps([11,1,9,3])).then(c=>({default:c.IncomeExpenseReport}))),St=f.lazy(()=>E(()=>import("../DivisionStatementsPanel.tsx-DsrsM4xr.js"),__vite__mapDeps([12,1,9,3])).then(c=>({default:c.DivisionStatementsPanel}))),bt=f.lazy(()=>E(()=>import("../ChartOfAccountsPanel.tsx-OHF2hpai.js"),__vite__mapDeps([13,1,3])).then(c=>({default:c.ChartOfAccountsPanel}))),Et=f.lazy(()=>E(()=>import("../BankAccountPanel.tsx-gvECbw6N.js"),__vite__mapDeps([14,1,2,15,3,16])).then(c=>({default:c.BankAccountPanel}))),Tt=f.lazy(()=>E(()=>import("../ClosingPanel.tsx-dJUMi3ol.js"),__vite__mapDeps([17,1,3])).then(c=>({default:c.ClosingPanel}))),Nt=f.lazy(()=>E(()=>import("../SampleDataPanel.tsx-BsM7pWKT.js"),__vite__mapDeps([18,1,3])).then(c=>({default:c.SampleDataPanel}))),It=f.lazy(()=>E(()=>import("../ExportPanel.tsx-CcTqncdm.js"),__vite__mapDeps([19,1,3])).then(c=>({default:c.ExportPanel}))),Dt=f.lazy(()=>E(()=>import("../LocalStoragePanel.tsx-BxEisxGN.js"),__vite__mapDeps([20,1,3])).then(c=>({default:c.LocalStoragePanel}))),Ot=f.lazy(()=>E(()=>import("../SettingsPanel.tsx-mc_yc5GR.js"),__vite__mapDeps([21,1,3])).then(c=>({default:c.SettingsPanel}))),xt=f.lazy(()=>E(()=>import("../PrintPanel.tsx-EYeI79qq.js"),__vite__mapDeps([22,1,3])).then(c=>({default:c.PrintPanel}))),Rt=f.lazy(()=>E(()=>import("../JsonSpecView.tsx-2YNTk7X6.js"),__vite__mapDeps([23,1,3])).then(c=>({default:c.JsonSpecView}))),_t=f.lazy(()=>E(()=>import("../ManualView.tsx-BXisQnd2.js"),__vite__mapDeps([24,1,3])).then(c=>({default:c.ManualView}))),Pt=f.lazy(()=>E(()=>import("../PaymentTestPanel.tsx-DBYYp7ZH.js"),__vite__mapDeps([25,1,2,15,6,3]))),jt=()=>d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",color:"var(--color-text-secondary)"},children:d.jsx("div",{children:"読み込み中..."})}),wt=({engine:c,onUpdate:e})=>{const{activeMenu:t}=V(),i=()=>{switch(t){case"freeeInput":return d.jsx(ht,{engine:c,onChange:e});case"bankImport":return d.jsx(yt,{accountingEngine:c,onComplete:n=>{e(),alert(`インポート完了: ${n.importedJournals}件の仕訳を登録しました`)}});case"auxiliary":return d.jsx(ft,{engine:c,onChange:e});case"incomeDetail":return d.jsx(At,{engine:c});case"expenseDetail":return d.jsx(gt,{engine:c});case"report":return d.jsx("section",{className:"mt-2",children:d.jsx(Ct,{engine:c})});case"divisionStatements":return d.jsx(St,{engine:c});case"chart":return d.jsx(bt,{engine:c,onChanged:e});case"bankAccounts":return d.jsx("section",{className:"mt-2",children:d.jsx(Et,{engine:c,onChanged:e})});case"settings":return d.jsx(Ot,{engine:c,onApplied:e});case"closing":return d.jsx(Tt,{engine:c,onChange:e});case"sampleData":return d.jsx("section",{className:"mt-2",children:d.jsx(Nt,{engine:c,onChange:e})});case"export":return d.jsxs(d.Fragment,{children:[d.jsx(It,{engine:c,onImported:e}),d.jsx(Dt,{engine:c,onLoaded:e}),d.jsx(xt,{})]});case"spec":return d.jsx(Rt,{engine:c});case"paymentTest":return d.jsx("section",{className:"mt-2",children:d.jsx(Pt,{})});case"manual":return d.jsx("section",{className:"mt-2",children:d.jsx(_t,{})});default:return d.jsxs("div",{className:"text-center mt-5",children:[d.jsx("h3",{children:"ページが見つかりません"}),d.jsx("p",{children:"選択されたメニュー項目に対応するページが存在しません。"})]})}};return d.jsx(f.Suspense,{fallback:d.jsx(jt,{}),children:d.jsx("section",{className:"mt-2",children:i()})})},Bt=({isOpen:c,title:e,message:t,confirmText:i="確認",cancelText:n="キャンセル",onConfirm:o,onCancel:r,isDangerous:s=!1})=>{if(!c)return null;const a=()=>{o()},u=()=>{r()},l=p=>{p.target===p.currentTarget&&u()};return d.jsx("div",{className:"confirm-dialog-backdrop",onClick:l,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:d.jsxs("div",{className:"confirm-dialog",style:{backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",padding:"24px",maxWidth:"400px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[d.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"20px",fontWeight:"bold",color:s?"#dc3545":"#333"},children:e}),d.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"16px",lineHeight:"1.5",color:"#666"},children:t}),d.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[d.jsx("button",{onClick:u,style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ddd",backgroundColor:"#fff",color:"#333",fontSize:"14px",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor="#fff"},children:n}),d.jsx("button",{onClick:a,style:{padding:"8px 16px",borderRadius:"4px",border:"none",backgroundColor:s?"#dc3545":"#007bff",color:"#fff",fontSize:"14px",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor=s?"#c82333":"#0056b3"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor=s?"#dc3545":"#007bff"},children:i})]})]})})},Mt=()=>{const[c]=f.useState(()=>new be),[,e]=f.useState(0),t=()=>e(o=>o+1),[i,n]=f.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}});return d.jsxs(mt,{children:[d.jsx(wt,{engine:c,onUpdate:t}),d.jsx(Bt,{isOpen:i.isOpen,title:i.title,message:i.message,onConfirm:i.onConfirm,onCancel:()=>n({...i,isOpen:!1}),isDangerous:i.isDangerous})]})};var oe,te=ue;oe=te.createRoot,te.hydrateRoot;const re=f.createContext(null),Lt=({children:c})=>{const[e,t]=f.useState([]),i=(o,r="info")=>{const s=Date.now()+Math.floor(Math.random()*1e3);t(a=>[...a,{id:s,kind:r,message:o}]),setTimeout(()=>t(a=>a.filter(u=>u.id!==s)),4e3)},n=f.useMemo(()=>({show:i}),[]);return d.jsxs(re.Provider,{value:n,children:[c,d.jsx("div",{style:{position:"fixed",right:12,top:12,zIndex:2e3,display:"flex",flexDirection:"column",gap:8},children:e.map(o=>d.jsx("div",{className:`alert alert-${o.kind} shadow`,style:{margin:0,padding:"8px 12px"},children:o.message},o.id))})]})},Ft=()=>{const c=f.useContext(re);if(!c)throw new Error("useToast must be used within ToastProvider");return c},Jt=document.getElementById("root");oe(Jt).render(d.jsx(le.StrictMode,{children:d.jsx(Lt,{children:d.jsx(Mt,{})})}));export{be as A,Kt as J,q as T,De as d,d as j,Ht as p,Vt as s,Ft as u};
