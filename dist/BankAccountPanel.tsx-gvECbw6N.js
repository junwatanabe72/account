import{j as e}from"./assets/index-DNcHv8Gn.js";import{r as c}from"./chunk-DJ1oPbzn.js";import{d as b}from"./chunk-xo-tfjFm.js";import{B as S}from"./chunk-D7WOVkBo.js";import"./chunk-B6LuprgX.js";const w=({type:p,message:i,onClose:l,duration:m=5e3})=>{c.useEffect(()=>{const d=setTimeout(()=>{l()},m);return()=>clearTimeout(d)},[m,l]);const n=()=>{switch(p){case"success":return"alert alert-success";case"error":return"alert alert-danger";case"warning":return"alert alert-warning";case"info":default:return"alert alert-info"}},t=()=>{switch(p){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":default:return"â„¹ï¸"}};return e.jsx("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:9999,maxWidth:"500px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:e.jsxs("div",{className:`${n()} d-flex align-items-start`,children:[e.jsx("span",{style:{marginRight:"10px",fontSize:"1.2em"},children:t()}),e.jsx("div",{style:{flex:1},children:i.split(`
`).map((d,u)=>e.jsx("div",{children:d},u))}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:l,style:{marginLeft:"10px",cursor:"pointer",background:"none",border:"none",fontSize:"1.2em"},children:"Ã—"})]})})},B=({engine:p,onChanged:i})=>{const[l,m]=c.useState(b),[n,t]=c.useState(null),[d,u]=c.useState(!1),[j,N]=c.useState(!1),[r]=c.useState(()=>new S(b)),[x,y]=c.useState(null),[g,o]=c.useState(null);c.useEffect(()=>{const s=a=>{m(r.getAccounts(!0)),i==null||i()};return r.addChangeListener(s),()=>{r.removeChangeListener(s)}},[r,i]);const f=c.useMemo(()=>j?l:l.filter(s=>s.isActive),[l,j]),A=()=>({id:`account_${Date.now()}`,code:"",name:"",shortName:"",accountType:"savings",division:"KANRI",bankName:"",branchName:"",accountNumber:"",accountHolder:"",balance:0,isActive:!0,description:"",displayOrder:l.length+1}),v=c.useCallback(s=>{var h;if(!s.success){o({type:"error",message:((h=s.errors)==null?void 0:h.join(`
`))||"å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ"});return}let a="å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚";s.affectedTransactions&&s.affectedTransactions.length>0&&(a+=`
${s.affectedTransactions.length}ä»¶ã®å–å¼•ãŒå½±éŸ¿ã‚’å—ã‘ã¾ã™ã€‚`),s.affectedAccounts&&s.affectedAccounts.length>1&&(a+=`
${s.affectedAccounts.length}ä»¶ã®é–¢é€£å£åº§ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚`),s.errors&&s.errors.length>0?o({type:"warning",message:a+`
è­¦å‘Š: `+s.errors.join(`
`)}):o({type:"success",message:a}),y(s)},[]),k=()=>{if(!n)return;if(!n.code||!n.name){o({type:"error",message:"å£åº§ã‚³ãƒ¼ãƒ‰ã¨å£åº§åã¯å¿…é ˆã§ã™"});return}let s;if(d)s=r.addAccount(n);else{const a=l.find(h=>h.id===n.id);if(a)s=r.updateAccount(a.code,n);else{o({type:"error",message:"æ›´æ–°å¯¾è±¡ã®å£åº§ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"});return}}v(s),s.success&&(t(null),u(!1))},T=s=>{const a=r.disableAccount(s.code);if(a.affectedTransactions&&a.affectedTransactions.length>0){const h=`${s.name}ã‚’éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¾ã™ã‹ï¼Ÿ

è­¦å‘Š: ã“ã®å£åº§ã¯${a.affectedTransactions.length}ä»¶ã®å–å¼•ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã™ã‚‹ã¨ã€ã“ã‚Œã‚‰ã®å–å¼•ã®æ±ºæ¸ˆå£åº§ã¨ã—ã¦ä½¿ç”¨ã§ããªããªã‚Šã¾ã™ã€‚`;if(!confirm(h))return}else if(!confirm(`${s.name}ã‚’éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¾ã™ã‹ï¼Ÿ`))return;v(a)},C=s=>{const a=r.enableAccount(s.code);v(a)};return e.jsxs("div",{className:"bank-account-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{children:"ðŸ¦ å£åº§ç®¡ç†"}),e.jsxs("div",{className:"header-controls",children:[e.jsxs("label",{className:"show-inactive-toggle",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:s=>N(s.target.checked)}),"éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚‚è¡¨ç¤º"]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{t(A()),u(!0)},children:"âž• æ–°è¦å£åº§è¿½åŠ "})]})]}),e.jsx("div",{className:"accounts-grid",children:e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ã‚³ãƒ¼ãƒ‰"}),e.jsx("th",{children:"å£åº§å"}),e.jsx("th",{children:"ç¨®åˆ¥"}),e.jsx("th",{children:"åŒºåˆ†"}),e.jsx("th",{children:"éŠ€è¡Œå"}),e.jsx("th",{children:"æ”¯åº—å"}),e.jsx("th",{children:"å£åº§ç•ªå·"}),e.jsx("th",{children:"çŠ¶æ…‹"}),e.jsx("th",{children:"æ“ä½œ"})]})}),e.jsxs("tbody",{children:[f.map(s=>e.jsxs("tr",{className:s.isActive?"":"inactive",children:[e.jsx("td",{children:s.code}),e.jsx("td",{children:e.jsxs("div",{className:"account-name",children:[e.jsx("strong",{children:s.name}),s.shortName&&e.jsxs("span",{className:"short-name",children:["(",s.shortName,")"]})]})}),e.jsxs("td",{children:[s.accountType==="cash"&&"ç¾é‡‘",s.accountType==="savings"&&"æ™®é€šé é‡‘",s.accountType==="checking"&&"å½“åº§é é‡‘",s.accountType==="time_deposit"&&"å®šæœŸé é‡‘"]}),e.jsx("td",{children:e.jsxs("span",{className:`division-badge ${s.division.toLowerCase()}`,children:[s.division==="KANRI"&&"ç®¡ç†",s.division==="SHUZEN"&&"ä¿®ç¹•",s.division==="BOTH"&&"å…±é€š"]})}),e.jsx("td",{children:s.bankName||"-"}),e.jsx("td",{children:s.branchName||"-"}),e.jsx("td",{children:s.accountNumber||"-"}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.isActive?"active":"inactive"}`,children:s.isActive?"æœ‰åŠ¹":"ç„¡åŠ¹"})}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>{t(s),u(!1)},children:"ç·¨é›†"}),s.isActive?e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>T(s),children:"ç„¡åŠ¹åŒ–"}):e.jsx("button",{className:"btn btn-sm btn-outline-success",onClick:()=>C(s),children:"æœ‰åŠ¹åŒ–"})]})})]},s.id)),f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"text-center text-muted",children:j?"å£åº§ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“":"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå£åº§ãŒã‚ã‚Šã¾ã›ã‚“"})})]})]})}),n&&e.jsx("div",{className:"modal-backdrop",onClick:()=>t(null),children:e.jsxs("div",{className:"edit-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:d?"æ–°è¦å£åº§è¿½åŠ ":"å£åº§ç·¨é›†"}),e.jsx("button",{className:"close-btn",onClick:()=>t(null),children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["å£åº§ã‚³ãƒ¼ãƒ‰ ",e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{type:"text",value:n.code,onChange:s=>t({...n,code:s.target.value}),placeholder:"ä¾‹: 1105"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["å£åº§å ",e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{type:"text",value:n.name,onChange:s=>t({...n,name:s.target.value}),placeholder:"ä¾‹: æ™®é€šé é‡‘ï¼ˆç®¡ç†ï¼‰"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç•¥ç§°"}),e.jsx("input",{type:"text",value:n.shortName,onChange:s=>t({...n,shortName:s.target.value}),placeholder:"ä¾‹: ç®¡ç†å£åº§"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å£åº§ç¨®åˆ¥"}),e.jsxs("select",{value:n.accountType,onChange:s=>t({...n,accountType:s.target.value}),children:[e.jsx("option",{value:"cash",children:"ç¾é‡‘"}),e.jsx("option",{value:"savings",children:"æ™®é€šé é‡‘"}),e.jsx("option",{value:"checking",children:"å½“åº§é é‡‘"}),e.jsx("option",{value:"time_deposit",children:"å®šæœŸé é‡‘"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ä¼šè¨ˆåŒºåˆ†"}),e.jsxs("select",{value:n.division,onChange:s=>t({...n,division:s.target.value}),children:[e.jsx("option",{value:"KANRI",children:"ç®¡ç†ä¼šè¨ˆ"}),e.jsx("option",{value:"SHUZEN",children:"ä¿®ç¹•ä¼šè¨ˆ"}),e.jsx("option",{value:"BOTH",children:"å…±é€š"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"éŠ€è¡Œå"}),e.jsx("input",{type:"text",value:n.bankName||"",onChange:s=>t({...n,bankName:s.target.value}),placeholder:"ä¾‹: ä¸‰è±UFJéŠ€è¡Œ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ”¯åº—å"}),e.jsx("input",{type:"text",value:n.branchName||"",onChange:s=>t({...n,branchName:s.target.value}),placeholder:"ä¾‹: â—‹â—‹æ”¯åº—"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å£åº§ç•ªå·"}),e.jsx("input",{type:"text",value:n.accountNumber||"",onChange:s=>t({...n,accountNumber:s.target.value}),placeholder:"ä¾‹: 1234567"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åç¾©äºº"}),e.jsx("input",{type:"text",value:n.accountHolder||"",onChange:s=>t({...n,accountHolder:s.target.value}),placeholder:"ä¾‹: â—‹â—‹ãƒžãƒ³ã‚·ãƒ§ãƒ³ç®¡ç†çµ„åˆ"})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"èª¬æ˜Žãƒ»å‚™è€ƒ"}),e.jsx("textarea",{value:n.description||"",onChange:s=>t({...n,description:s.target.value}),rows:3,placeholder:"ã“ã®å£åº§ã®ç”¨é€”ã‚„æ³¨æ„äº‹é …ãªã©"})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>t(null),children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsx("button",{className:"btn btn-primary",onClick:k,children:"ä¿å­˜"})]})]})}),x&&x.affectedTransactions&&x.affectedTransactions.length>0&&e.jsx("div",{className:"sync-result-details",children:e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("h4",{children:"å½±éŸ¿ã‚’å—ã‘ã‚‹å–å¼•"}),e.jsxs("p",{children:[x.affectedTransactions.length,"ä»¶ã®å–å¼•ãŒå½±éŸ¿ã‚’å—ã‘ã¾ã™ã€‚"]}),e.jsxs("details",{children:[e.jsx("summary",{children:"è©³ç´°ã‚’è¡¨ç¤º"}),e.jsx("ul",{children:x.affectedTransactions.map(s=>e.jsxs("li",{children:["å–å¼•ID: ",s]},s))})]})]})}),g&&e.jsx(w,{type:g.type,message:g.message,onClose:()=>o(null)})]})};export{B as BankAccountPanel};
