import{j as e}from"./assets/index-DNcHv8Gn.js";import{R as j}from"./chunk-DJ1oPbzn.js";import"./chunk-B6LuprgX.js";const g=({engine:d,onChanged:m})=>{const[h,o]=j.useState(d.getChartOfAccounts()),[c,i]=j.useState({code:"",name:"",type:"ASSET",normalBalance:"DEBIT",level:4,parentCode:void 0,division:void 0,isActive:!0}),v=()=>o(d.getChartOfAccounts()),u=()=>{var t;const s=[];for(const l of h){const n=d.addOrUpdateAccount(l);n.success||s.push(`${l.code}: ${((t=n.errors)==null?void 0:t.join(", "))||"エラーが発生しました"}`)}m(),s.length?alert(`一部保存に失敗:
`+s.join(`
`)):alert("勘定科目を保存しました")},x=()=>{var t;if(!c.code||!c.name){alert("コードと名称は必須です");return}const s=d.addOrUpdateAccount(c);if(!s.success){alert(((t=s.errors)==null?void 0:t.join(", "))||"エラーが発生しました");return}o(d.getChartOfAccounts()),i({code:"",name:"",type:"ASSET",normalBalance:"DEBIT",level:4,parentCode:void 0,division:void 0,isActive:!0}),m()},p=s=>{var t;d.setAccountActive(s,!((t=h.find(l=>l.code===s))!=null&&t.isActive)),o(d.getChartOfAccounts()),m()},N=["ASSET","LIABILITY","EQUITY","REVENUE","EXPENSE"],f=["DEBIT","CREDIT"];return e.jsxs("div",{className:"card mt-3",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"勘定科目マスタ"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:u,children:"保存"})]}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-3 p-2 border rounded",children:e.jsxs("div",{className:"row g-2 align-items-end",children:[e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"コード"}),e.jsx("input",{className:"form-control",value:c.code,onChange:s=>i({...c,code:s.target.value})})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"名称"}),e.jsx("input",{className:"form-control",value:c.name,onChange:s=>i({...c,name:s.target.value})})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"種別"}),e.jsx("select",{className:"form-select",value:c.type,onChange:s=>i({...c,type:s.target.value}),children:N.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"正規残"}),e.jsx("select",{className:"form-select",value:c.normalBalance,onChange:s=>i({...c,normalBalance:s.target.value}),children:f.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"col-md-1",children:[e.jsx("label",{className:"form-label",children:"レベル"}),e.jsx("input",{className:"form-control",type:"number",min:1,max:5,value:c.level,onChange:s=>i({...c,level:Number(s.target.value)})})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"親コード"}),e.jsx("input",{className:"form-control",value:c.parentCode??"",onChange:s=>i({...c,parentCode:s.target.value||void 0})})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"区分"}),e.jsxs("select",{className:"form-select",value:c.division??"",onChange:s=>i({...c,division:s.target.value||void 0}),children:[e.jsx("option",{value:"",children:"(なし)"}),e.jsx("option",{value:"KANRI",children:"KANRI"}),e.jsx("option",{value:"SHUZEN",children:"SHUZEN"}),e.jsx("option",{value:"PARKING",children:"PARKING"}),e.jsx("option",{value:"SPECIAL",children:"SPECIAL"})]})]}),e.jsxs("div",{className:"col-md-1 form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!c.isActive,onChange:s=>i({...c,isActive:s.target.checked})}),e.jsx("label",{className:"form-check-label",children:"有効"})]}),e.jsx("div",{className:"col-md-2 text-end",children:e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:x,children:"科目追加"})})]})}),e.jsx("div",{className:"d-flex justify-content-end mb-2",children:e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:v,children:"再読込"})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"コード"}),e.jsx("th",{children:"名称"}),e.jsx("th",{children:"種別"}),e.jsx("th",{children:"正規残"}),e.jsx("th",{children:"レベル"}),e.jsx("th",{children:"親"}),e.jsx("th",{children:"区分"}),e.jsx("th",{children:"有効"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:h.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap"},children:s.code}),e.jsx("td",{children:e.jsx("input",{className:"form-control form-control-sm",value:s.name,onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,name:l.target.value}:a))})}),e.jsx("td",{children:e.jsx("select",{className:"form-select form-select-sm",value:s.type,onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,type:l.target.value}:a)),children:["ASSET","LIABILITY","EQUITY","REVENUE","EXPENSE"].map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsx("td",{children:e.jsx("select",{className:"form-select form-select-sm",value:s.normalBalance,onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,normalBalance:l.target.value}:a)),children:["DEBIT","CREDIT"].map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsx("td",{style:{maxWidth:80},children:e.jsx("input",{className:"form-control form-control-sm",type:"number",min:1,max:5,value:s.level,onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,level:Number(l.target.value)}:a))})}),e.jsx("td",{style:{maxWidth:120},children:e.jsx("input",{className:"form-control form-control-sm",value:s.parentCode??"",onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,parentCode:l.target.value||null}:a))})}),e.jsx("td",{style:{maxWidth:140},children:e.jsxs("select",{className:"form-select form-select-sm",value:s.division??"",onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,division:l.target.value||null}:a)),children:[e.jsx("option",{value:"",children:"(なし)"}),e.jsx("option",{value:"KANRI",children:"KANRI"}),e.jsx("option",{value:"SHUZEN",children:"SHUZEN"}),e.jsx("option",{value:"PARKING",children:"PARKING"}),e.jsx("option",{value:"SPECIAL",children:"SPECIAL"})]})}),e.jsx("td",{className:"text-center",children:e.jsx("input",{type:"checkbox",className:"form-check-input",checked:!!s.isActive,onChange:l=>o(n=>n.map((a,r)=>r===t?{...a,isActive:l.target.checked}:a))})}),e.jsx("td",{className:"text-end",children:e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>p(s.code),children:s.isActive?"無効化":"有効化"})})]},s.code))})]})})]})]})};export{g as ChartOfAccountsPanel};
