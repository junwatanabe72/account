# Phase 14: 銀行入金処理と未収金管理

## 📋 概要
Phase 14では、銀行明細CSVを活用した入金処理の自動化と未収金管理機能をPOCとして実装します。

## 🎯 目的
- **業務効率化**: 手動での仕訳入力作業を自動化
- **未収金管理**: 入金状況の可視化と消し込み処理
- **精度向上**: 人為的ミスの削減

## 📁 ドキュメント構成

### 1. [ユースケース](./phase14-use-cases.md)
実際の業務シナリオに基づいた7つの主要ユースケース：
- UC-01: 銀行明細CSVのインポート
- UC-02: 未収金の自動計上
- UC-03: 過入金の処理
- UC-04: 消し込み処理
- UC-05: 入金者不明の処理
- UC-06: 複数月まとめ入金
- UC-07: 返金処理

### 2. [実装計画](./phase14-implementation-plan.md)
POC実装の詳細設計と開発計画：
- アーキテクチャ設計
- 詳細クラス設計
- サンプルデータ
- テスト計画
- 4日間の実装スケジュール

### 3. [全体ロードマップ](./implementation-roadmap-phase14-16.md)
Phase 14-16の全体計画：
- Phase 14: 未収金・未払金管理（現在）
- Phase 15: 消し込み処理の高度化
- Phase 16: 決算締め処理

## 🚀 POCのスコープ

### ✅ 実装する機能
1. **CSVインポート**
   - 複数銀行フォーマット対応
   - 文字コード自動判定
   - プレビュー機能

2. **自動仕訳生成**
   - 摘要欄の自動解析
   - 住戸番号の抽出
   - 標準請求額との照合

3. **未収金管理**
   - 差額の自動計算
   - 未収金の自動計上
   - 手動消し込み機能

4. **基本レポート**
   - 未収金一覧
   - 入金状況サマリー

### ❌ 将来実装（スコープ外）
- 請求書発行機能
- 自動消し込み（次回入金時）
- 延滞金計算
- 督促管理
- 口座振替連携

## 💡 想定される効果

### 定量的効果
- **作業時間**: 80%削減（月40時間→8時間）
- **ミス率**: 90%削減
- **処理速度**: 1000件を5分で処理

### 定性的効果
- リアルタイムな未収金把握
- 監査対応の迅速化
- 担当者の負担軽減

## 🔧 技術スタック
- **Frontend**: React + TypeScript
- **State管理**: Zustand（既存プロジェクトに準拠）
- **CSV処理**: PapaParse（既存インストール済み）
- **仕訳エンジン**: 既存のJournalService拡張

## 📊 サンプルシナリオ

### 正常な入金処理
```
入金: 101号室から25,000円
標準: 管理費15,000円 + 修繕費10,000円
処理: 完全一致 → 正常仕訳作成
```

### 一部入金（未収金発生）
```
入金: 202号室から20,000円
標準: 管理費20,000円 + 修繕費15,000円
処理: 15,000円不足 → 未収金計上
```

### 過入金（前受金計上）
```
入金: 303号室から50,000円（2ヶ月分）
標準: 月額25,000円
処理: 25,000円超過 → 前受金計上
```

## 📈 次のステップ

1. **Phase 14 POC実装**（4日間）
   - Day 1: 基盤実装
   - Day 2: 照合エンジン
   - Day 3: 未収金管理
   - Day 4: UI実装とテスト

2. **評価とフィードバック**
   - ユーザーテスト
   - パフォーマンス測定
   - 改善点の洗い出し

3. **本格実装への移行**
   - Phase 15: 高度な消し込み
   - Phase 16: 決算締め処理

## 📝 注意事項

- このPOCは**システム内で完結**する機能に焦点を当てています
- 請求処理は現時点では**システム外**で行う想定です
- 実際の銀行明細フォーマットは銀行により異なるため、アダプターパターンで対応

---

このPhase 14の実装により、マンション管理組合の経理業務の大幅な効率化が期待できます。